<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name="robots" content="all"><meta name="ir-site-verification-token" value="626123791"><title>GraalVM and heap size of the native image - how to set it?</title><meta name="keywords" content="java,ratpack,graalvm,xmx"><link rel="dns-prefetch" href="//fonts.googleapis.com"><link rel="dns-prefetch" href="//cdnjs.cloudflare.com"><link rel="dns-prefetch" href="//stackpath.bootstrapcdn.com"><link rel="shortcut icon" type="image/png" href="/favicon_new.png"><link rel="canonical" href="https://e.printstacktrace.blog/graalvm-heap-size-of-native-image-how-to-set-it/"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Code+Pro:wght@400;500;700|Poppins:300,400,400i,700|Montserrat:400,600,700|Roboto:300,400,400i,700|Lora:400,400i,700,700i&amp;display=swap"><link rel="stylesheet" href="//stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous"><link rel="stylesheet" href="/css/main.css?v=71"><link rel="stylesheet" href="/css/highlight.css?v=71"><meta name="description" content="In this short blog post, I would like to show you how to set a heap size of the application executed from the native image generated with GraalVM. We will also take a quick look at the effects caused"><meta property="og:type" content="article"><meta property="og:title" content="GraalVM and heap size of the native image - how to set it?"><meta property="og:url" content="https://e.printstacktrace.blog/graalvm-heap-size-of-native-image-how-to-set-it/"><meta property="og:site_name" content="e.printstacktrace.blog - I help you become a better software developer."><meta property="og:description" content="In this short blog post, I would like to show you how to set a heap size of the application executed from the native image generated with GraalVM. We will also take a quick look at the effects caused"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://e.printstacktrace.blog/images/cards/29.png"><meta property="article:published_time" content="2019-04-02T13:38:38.000Z"><meta property="article:modified_time" content="2019-04-02T13:38:38.000Z"><meta property="article:author" content="Szymon Stepniak"><meta property="article:tag" content="java"><meta property="article:tag" content="ratpack"><meta property="article:tag" content="graalvm"><meta property="article:tag" content="xmx"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image" content="https://e.printstacktrace.blog/images/cards/29.png"><meta name="twitter:creator" content="@wololock"><script type="application/ld+json">{"@context":"https://schema.org","@graph":[{"@type":["Person","Organization"],"@id":"https://e.printstacktrace.blog/#/schema/person/wololock","name":"Szymon Stepniak","description":"I help you become a better software developer.","image":{"@type":"ImageObject","@id":"https://e.printstacktrace.blog/#avatar","inLanguage":"en-US","url":"https://www.gravatar.com/avatar/b22c1842c6e8f7f2b9b3ed8c0d4efb4d?s=200","caption":"Szymon Stepniak"},"logo":{"@id":"https://e.printstacktrace.blog/#avatar"},"sameAs":["https://twitter.com/wololock","https://github.com/wololock","https://stackoverflow.com/users/2194470/szymon-stepniak","https://www.youtube.com/c/eprintstacktrace"]},{"@type":"WebSite","@id":"https://e.printstacktrace.blog/#website","url":"https://e.printstacktrace.blog","name":"e.printstacktrace.blog - I help you become a better software developer.","description":"Blog about programming, created by Upwork's Top Rated freelancer, 10+ years experienced Java/Groovy developer. Contact me if you are looking for an experienced and high quality consultant."},{"@type":"WebPage","@id":"https://e.printstacktrace.blog/graalvm-heap-size-of-native-image-how-to-set-it/#webpage","url":"https://e.printstacktrace.blog/graalvm-heap-size-of-native-image-how-to-set-it/","name":"GraalVM and heap size of the native image - how to set it?","isPartOf":{"@id":"https://e.printstacktrace.blog/#website"},"datePublished":"2019-04-02T13:38:38.000Z","dateModified":"2019-04-02T13:38:38.000Z","description":"\nIn this short blog post, I would like to show you how to set a heap size of the application executed from the\nnative image generated with GraalVM. We will also take a quick look at the effects\ncaused the maximum heap size change.\n","inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://e.printstacktrace.blog/graalvm-heap-size-of-native-image-how-to-set-it/"]}]},{"@type":"Article","@id":"https://e.printstacktrace.blog/graalvm-heap-size-of-native-image-how-to-set-it/#article","isPartOf":{"@id":"https://e.printstacktrace.blog/graalvm-heap-size-of-native-image-how-to-set-it/#webpage"},"author":{"@id":"https://e.printstacktrace.blog/#/schema/person/wololock"},"headline":"GraalVM and heap size of the native image - how to set it?","datePublished":"2019-04-02T13:38:38.000Z","dateModified":"2019-04-02T13:38:38.000Z","mainEntityOfPage":{"@id":"https://e.printstacktrace.blog/graalvm-heap-size-of-native-image-how-to-set-it/#webpage"},"publisher":{"@id":"https://e.printstacktrace.blog/#/schema/person/wololock"},"keywords":"java,ratpack,graalvm,xmx","image":{"@type":"ImageObject","@id":"https://e.printstacktrace.blog/graalvm-heap-size-of-native-image-how-to-set-it/#primaryimage","url":"https://e.printstacktrace.blog/images/cards/29.png","inLanguage":"en-US","caption":"GraalVM and heap size of the native image - how to set it?"},"inLanguage":"en-US"},{"@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"https://e.printstacktrace.blog"},{"@type":"ListItem","position":2,"name":"Learning Java","item":"https://e.printstacktrace.blog/learning-java/"},{"@type":"ListItem","position":3,"name":"GraalVM and heap size of the native image - how to set it?"}]}]}</script><meta name="generator" content="Hexo 5.2.0"><link rel="alternate" href="/atom.xml" title="e.printstacktrace.blog - I help you become a better software developer." type="application/atom+xml">
<style>.img-lazyload-container{overflow:hidden;max-width:100%}.img-lazyload-container img{max-width:100%;display:block;height:auto;transition:opacity .5s ease-in-out}.img-lazyload-container img:not([src]){height:0;opacity:0}</style></head><body><header class="fixed-top" id="header"><div class="container"><nav class="navbar navbar-light mx-0 px-0 justify-content-start"><a class="gatr" href="/" data-type="nav" data-name="Home">Home</a><a class="gatr" href="/about" data-type="nav" data-name="About">About</a><a class="gatr" href="/archives" data-type="nav" data-name="Archives">Archives</a><a class="gatr" href="/resources" data-type="nav" data-name="Tools &amp; Resources">Tools & Resources</a><a class="gatr" href="/support-me" data-type="nav" data-name="Support me">Support me</a></nav></div></header><main id="main"><section class="sidebar-enabled" id="content"><div class="container"><div class="row"><div class="col-lg-3 bg-primary sidebar pt-5 d-flex align-items-start flex-column order-1 pr-lg-0"><div class="mb-auto"><div class="text-center pt-lg-5 pl-3"><a href="/about"><img class="rounded-circle mb-4" src="https://www.gravatar.com/avatar/b22c1842c6e8f7f2b9b3ed8c0d4efb4d?s=200" height="96"></a><h5>Hi! üëã I'm Szymon</h5><p class="small">I help you become a better software developer.</p></div><div class="my-4 pl-2 text-lg-right text-center"><ul class="social-media"><li><a class="gatr" target="_blank" rel="noopener" href="https://twitter.com/wololock" data-type="social-media" data-name="Twitter" title="Twitter"><i class="fa fa-twitter"></i><span class="number">1.14k</span><span class="description">Followers</span></a></li><li><a class="gatr" target="_blank" rel="noopener" href="https://www.youtube.com/eprintstacktrace" data-type="social-media" data-name="YouTube" title="YouTube"><i class="fa fa-youtube"></i><span class="number">2.19k</span><span class="description">Subscribers</span></a></li><li><a class="gatr" target="_blank" rel="noopener" href="https://github.com/wololock" data-type="social-media" data-name="Github" title="Github"><i class="fa fa-github"></i><span class="number">108</span><span class="description">Followers</span></a></li><li><a class="gatr" target="_blank" rel="noopener" href="https://stackoverflow.com/users/2194470/szymon-stepniak" data-type="social-media" data-name="StackOverflow" title="StackOverflow"><i class="fa fa-stack-overflow"></i><span class="number">29.9k</span><span class="description">Reputation</span></a></li></ul></div><div class="pl-4 mt-lg-5 pt-lg-2"><h4 class="h4 pt-4 mb-4 sans-serif">Latest posts from the <span class="h3 font-weight-bold">Learning Java</span></h4><div class="media align-items-center pb-1 mb-3"><a class="d-block gatr" href="/graalvm-heap-size-of-native-image-how-to-set-it/" data-type="latest-sidebar" data-name="GraalVM and heap size of the native image - how to set it?"><img class="rounded" src="/images/icons/31.png" width="64"></a><div class="media-body pl-2 ml-1"><h5 class="m-0 small" style="font-size:14px;font-weight:600;line-height:22px"><a class="sans-serif gatr" href="/graalvm-heap-size-of-native-image-how-to-set-it/" data-type="latest-sidebar" data-name="GraalVM and heap size of the native image - how to set it?">GraalVM and heap size of the native image - how to set it?</a></h5></div></div><div class="media align-items-center pb-1 mb-3"><a class="d-block gatr" href="/installing-graalvm-ee-1-0-0-rc14-with-sdkman/" data-type="latest-sidebar" data-name="Installing GraalVM EE 1.0.0-RC14 with SDKMAN!"><img class="rounded" src="/images/icons/27.png" width="64"></a><div class="media-body pl-2 ml-1"><h5 class="m-0 small" style="font-size:14px;font-weight:600;line-height:22px"><a class="sans-serif gatr" href="/installing-graalvm-ee-1-0-0-rc14-with-sdkman/" data-type="latest-sidebar" data-name="Installing GraalVM EE 1.0.0-RC14 with SDKMAN!">Installing GraalVM EE 1.0.0-RC14 with SDKMAN!</a></h5></div></div><div class="media align-items-center pb-1 mb-3"><a class="d-block gatr" href="/java-type-inference-generic-methods-chain-call/" data-type="latest-sidebar" data-name="Java 8 type inference in generic methods chain call - what might go wrong?"><img class="rounded" src="/images/icons/44.png" width="64"></a><div class="media-body pl-2 ml-1"><h5 class="m-0 small" style="font-size:14px;font-weight:600;line-height:22px"><a class="sans-serif gatr" href="/java-type-inference-generic-methods-chain-call/" data-type="latest-sidebar" data-name="Java 8 type inference in generic methods chain call - what might go wrong?">Java 8 type inference in generic methods chain call - what mi...</a></h5></div></div><div class="media align-items-center pb-1 mb-3"><a class="d-block gatr" href="/divide-a-list-to-lists-of-n-size-in-Java-8/" data-type="latest-sidebar" data-name="Divide a list to lists of n size in Java 8"><img class="rounded" src="/images/icons/39.png" width="64"></a><div class="media-body pl-2 ml-1"><h5 class="m-0 small" style="font-size:14px;font-weight:600;line-height:22px"><a class="sans-serif gatr" href="/divide-a-list-to-lists-of-n-size-in-Java-8/" data-type="latest-sidebar" data-name="Divide a list to lists of n size in Java 8">Divide a list to lists of n size in Java 8</a></h5></div></div><div class="text-center"><a class="view-all" href="/learning-java/" data-type="latest-sidebar" data-name="More &amp;raquo;"><span class="d-block m-0">More</span><i class="fas fa-chevron-down d-block m-0"></i></a></div></div><div class="pl-4 mt-5"><h4 class="mb-3">Popular categories</h4><ul class="list-unstyled"><li class="my-1"><a class="gatr" href="/groovy-cookbook/" data-type="sidebar-category" data-name="Groovy Cookbook">Groovy Cookbook<span class="count ml-2 mark">28</span></a></li><li class="my-1"><a class="gatr" href="/jenkins-pipeline-cookbook/" data-type="sidebar-category" data-name="Jenkins Pipeline Cookbook">Jenkins Pipeline Cookbook<span class="count ml-2 mark">9</span></a></li><li class="my-1"><a class="gatr" href="/programmers-bookshelf/" data-type="sidebar-category" data-name="Programmer's Bookshelf">Programmer's Bookshelf<span class="count ml-2 mark">6</span></a></li><li class="my-1"><a class="gatr" href="/micronaut-cookbook/" data-type="sidebar-category" data-name="Micronaut Cookbook">Micronaut Cookbook<span class="count ml-2 mark">4</span></a></li><li class="my-1"><a class="gatr" href="/ratpack-cookbook/" data-type="sidebar-category" data-name="Ratpack Cookbook">Ratpack Cookbook<span class="count ml-2 mark">4</span></a></li><li class="my-1"><a class="gatr" href="/learning-java/" data-type="sidebar-category" data-name="Learning Java">Learning Java<span class="count ml-2 mark">4</span></a></li><li class="my-1"><a class="gatr" href="/jq-cookbook/" data-type="sidebar-category" data-name="jq cookbook">jq cookbook<span class="count ml-2 mark">3</span></a></li><li class="my-1"><a class="gatr" href="/how-to/" data-type="sidebar-category" data-name="How to">How to<span class="count ml-2 mark">3</span></a></li><li class="my-1"><a class="gatr" href="/blog-reports/" data-type="sidebar-category" data-name="Blog Reports">Blog Reports<span class="count ml-2 mark">2</span></a></li></ul></div><div class="text-center"><div class="d-none d-lg-inline-block mb-5 pt-5"><a class="gatr" href="https://amzn.to/35QTnYE" data-type="banner" data-name="audible-premium-02" target="_blank"><img class="img-fluid" data-lazy="/images/yml/audible-02.png"></a></div><div class="d-inline-block d-lg-none py-3"><a class="gatr" href="https://click.linksynergy.com/deeplink?id=uow2LCEuhvQ&amp;mid=39197&amp;murl=https%3A%2F%2Fwww.udemy.com%2Ftopic%2Fdevops%2F" data-type="banner" data-name="udemy-devops-01" target="_blank"><img class="img-fluid" data-lazy="/images/yml/udemy-devops-01.png"></a></div></div></div><div class="spread-the-love pt-4 mt-lg-5"><div class="mb-lg-5 pb-5 pl-lg-4"><h3 class="mb-3">Don't miss anything - join my newsletter</h3><p class="text-justify">Additional materials and updates for subscribers. <b>No spam guaranteed</b>.<br>Unsubscribe at any time.</p><div id="ck-5bc70426c4-box"></div><script>function load_newsletter(e){var t=document.getElementById("ck-5bc70426c4-box");if(document.contains(t)){var n=t.parentElement;t.remove();var o=document.createElement("script");o.type="text/javascript",o.async=!0,o.src="https://tremendous-motivator-1432.ck.page/"+e+"/index.js",o.setAttribute("data-uid",e),n.appendChild(o),console.log("Convertkit "+e+" loaded.")}}window.addEventListener("scroll",function(e){var t=document.scrollingElement.scrollTop,n=document.getElementById("ck-5bc70426c4-box");document.contains(n)&&t>n.getBoundingClientRect().top- -500&&load_newsletter("5bc70426c4")})</script></div><div class="pl-lg-3 text-lg-left text-center"><p class="m-0 serif">Did you like this article?</p><h5 class="text-uppercase">Spread the <i class="fa fa-heart"></i>!</h5><ul class="mb-5"><li><a class="gatr" target="_blank" rel="noopener" href="https://twitter.com/intent/tweet?text=GraalVM and heap size of the native image - how to set it? https://e.printstacktrace.blog/graalvm-heap-size-of-native-image-how-to-set-it/ via @wololock" data-type="share" data-name="Shared on Twitter"><i class="fa fa-twitter"></i></a></li><li><a class="gatr" target="_blank" rel="noopener" href="https://www.linkedin.com/shareArticle?url=https://e.printstacktrace.blog/graalvm-heap-size-of-native-image-how-to-set-it/" data-type="share" data-name="Shared on LinkedIn"><i class="fa fa-linkedin"></i></a></li><li><a class="gatr" target="_blank" rel="noopener" href="https://www.facebook.com/sharer.php?u=https://e.printstacktrace.blog/graalvm-heap-size-of-native-image-how-to-set-it/" data-type="share" data-name="Shared on Facebook"><i class="fa fa-facebook-square"></i></a></li><li><a class="gatr" target="_blank" rel="noopener" href="http://www.reddit.com/submit?url=https://e.printstacktrace.blog/graalvm-heap-size-of-native-image-how-to-set-it/&amp;title=GraalVM and heap size of the native image - how to set it?" data-type="share" data-name="Shared on Reddit"><i class="fa fa-reddit"></i></a></li><li><a class="gatr" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/button/?url=https://e.printstacktrace.blog/graalvm-heap-size-of-native-image-how-to-set-it/&amp;media=https://e.printstacktrace.blog/images/cards/29.png&amp;description=GraalVM and heap size of the native image - how to set it?" data-type="share" data-name="Shared on Pinterest"><i class="fa fa-pinterest"></i></a></li><li><a class="gatr" target="_blank" rel="noopener" href="https://ko-fi.com/eprintstacktrace" data-type="share" data-name="Clicked on Ko-Fi">‚òïÔ∏è</a></li></ul></div></div></div><div class="col-lg-9 py-5 order-0"><div class="pr-lg-4 px-1 pt-lg-5"><nav aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a class="gatr" href="/" data-type="breadcrumb" data-name="/">e.printstacktrace.blog</a></li><li class="breadcrumb-item"><a class="gatr" href="/learning-java/" data-type="breadcrumb" data-name="Learning Java">Learning Java</a></li></ol></nav><article class="post-body"><h1>GraalVM and heap size of the native image - how to set it?</h1><div class="post-meta mb-4"><ul><li><time datetime="2019-04-02T13:38:38.000Z">April 2, 2019</time></li><li>6 min. read</li><li><a href="https://e.printstacktrace.blog/graalvm-heap-size-of-native-image-how-to-set-it/#disqus_thread">0 Comments</a></li></ul></div><div class="content"><div class="paragraph"><p>In this short blog post, I would like to show you how to set a heap size of the application executed from the native image generated with <a target="_blank" rel="noopener" href="https://www.graalvm.org/">GraalVM</a>. We will also take a quick look at the effects caused the maximum heap size change.</p></div><a id="more"></a><div class="sect1"><h2 id="graalvm-heap-size-setting">GraalVM heap size setting</h2><div class="sectionbody"><div class="paragraph"><p>If you want to set up the maximum heap size of the application executed from the native image, use&nbsp; <code>-Xmx&#123;n&#125;</code> command line option. For instance, if we want to set up a maximum heap size to <strong>128 MB</strong> we can do the following:</p></div><div class="listingblock"><div class="title">Listing 1. Setting maximum heap size to 128 MB</div><div class="content"><pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">./your-native-image-executable -Xmx128m</code></pre></div></div><div class="admonitionblock note"><table><tr><td class="icon"><i class="fa icon-note" title="Note"></i></td><td class="content">This blog post is published when the most recent version of GraalVM is <strong>1.0.0-RC14</strong>.</td></tr></table></div></div></div><div class="sect1"><h2 id="an-example">An example</h2><div class="sectionbody"><div class="paragraph"><p>In the following example, I will use the native image I&#8217;ve <a href="/ratpack-graalvm-how-to-start/" title="created for my demo Ratpack">created for my demo Ratpack</a> application. The only difference is that this time I have configured this application to use a single thread for handling event loop events. <em>(HTTP requests in particular.)</em></p></div><div class="admonitionblock note"><table><tr><td class="icon"><i class="fa icon-note" title="Note"></i></td><td class="content">In the following example I also use <code>-XX:+PrintGC</code>, <code>-XX:+PrintGCTimeStamps</code>, <code>-XX:+VerboseGC</code> and <code>+XX:+PrintHeapShape</code> flags to log verbose garbage collector activity to the console.</td></tr></table></div><div class="paragraph"><p>For testing purpose, I&#8217;m going to execute <strong>200</strong> parallel requests, repeated <strong>100</strong> times, so our application will have to handle <strong>20,000</strong> requests in total. I use <code>siege</code> <sup class="footnote">[<a id="_footnoteref_1" class="footnote" href="#_footnotedef_1" title="View footnote.">1</a>]</sup> tool to execute those requests. Firstly, let&#8217;s do this test with the application executed without specifying the heap size. However, what is the <strong>default maximum heap size</strong>? You can find it out using GraalVM polyglot launcher for instance:</p></div><div class="listingblock"><div class="title">Listing 2. Finding the default maximum heap size</div><div class="content"><pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">$ polyglot --native --help:vm | grep HeapSize
  --vm.XX:MaximumHeapSizePercent=80            The maximum heap size as percent of physical memory.
  --vm.Xmx&lt;value&gt;                              Sets the maximum size of the heap, in bytes. Default: MaximumHeapSizePercent * physical memory.</code></pre></div></div><div class="paragraph"><p>As you can see, it&#8217;s set to <strong>80%</strong> of the physical memory. In my case it is something around <strong>12.29 GB</strong>. Let&#8217;s run the application.</p></div><div class="listingblock"><div class="title">Listing 3. Running Ratpack application with the default max heap size</div><div class="content"><pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">$ ./ratpack-graalvm-demo -XX:+PrintGC -XX:+PrintGCTimeStamps -XX:+VerboseGC +XX:+PrintHeapShape
[main] INFO ratpack.server.RatpackServer - Starting server...
[main] INFO ratpack.server.RatpackServer - Building registry...
[main] INFO ratpack.server.RatpackServer - Ratpack started for http://localhost:5050</code></pre></div></div><div class="paragraph"><p>We can execute <strong>20,000</strong> requests now.</p></div><div class="listingblock"><div class="title">Listing 4. Executing 20k requests using <code>siege</code></div><div class="content"><pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">$ siege -c 200 -r 100 http://localhost:5050/
...
HTTP/1.1 200     0.01 secs:      53 bytes ==&gt; GET  /
HTTP/1.1 200     0.01 secs:      53 bytes ==&gt; GET  /
HTTP/1.1 200     0.00 secs:      53 bytes ==&gt; GET  /

Transactions:		       20000 hits
Availability:		      100.00 %
Elapsed time:		        4.31 secs
Data transferred:	        1.01 MB
Response time:		        0.03 secs
Transaction rate:	     4640.37 trans/sec
Throughput:		        0.23 MB/sec
Concurrency:		      143.19
Successful transactions:       20000
Failed transactions:	           0
Longest transaction:	        3.14
Shortest transaction:	        0.02</code></pre></div></div><div class="paragraph"><p>Let&#8217;s take a look at the console where the application is running.</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">$ ./ratpack-graalvm-demo -XX:+PrintGC -XX:+PrintGCTimeStamps -XX:+VerboseGC +XX:+PrintHeapShape
[main] INFO ratpack.server.RatpackServer - Starting server...
[main] INFO ratpack.server.RatpackServer - Building registry...
[main] INFO ratpack.server.RatpackServer - Ratpack started for http://localhost:5050
[Heap policy parameters:
  YoungGenerationSize: 268435456
      MaximumHeapSize: 13193507600
      MinimumHeapSize: 536870912
     AlignedChunkSize: 1048576
  LargeArrayThreshold: 131072]
[[36323 msec:  GC: before  epoch: 1  cause: CollectOnAllocation.Sometimes]
[36333 msec: Incremental GC (CollectOnAllocation.Sometimes) 261172K-&gt;17403K, 0.0105428 secs]
 [36333 msec:  GC: after   epoch: 1  cause: CollectOnAllocation.Sometimes  policy: by time: 50% in incremental collections  type: incremental
  collection time: 10542877 nanoSeconds]]</code></pre></div></div><div class="paragraph"><p>As you can see, there was no much activity from the garbage collector. Here what does the memory consumption of this process looks like:</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">$ ps ef -o command,vsize,rss,%mem,size | grep ratpack | head -n 1
 \_ ./ratpack-graalvm-demo  525924 280148  1.7 307328</code></pre></div></div><div class="paragraph"><p>It consumed <strong>280 MB</strong> RSS. Is it much? Maybe. Let&#8217;s run the same application with <code>-Xmx64m</code> and check if it makes any difference.</p></div><div class="listingblock"><div class="title">Listing 5. Running Ratpack application with max heap size set to 64 MB</div><div class="content"><pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">$ ./ratpack-graalvm-demo -XX:+PrintGC -XX:+PrintGCTimeStamps -XX:+VerboseGC +XX:+PrintHeapShape -Xmx64m
[main] INFO ratpack.server.RatpackServer - Starting server...
[main] INFO ratpack.server.RatpackServer - Building registry...
[main] INFO ratpack.server.RatpackServer - Ratpack started for http://localhost:5050</code></pre></div></div><div class="paragraph"><p>Application started. It&#8217;s time to execute the same amount of requests.</p></div><div class="listingblock"><div class="title">Listing 6. Executing 20k requests using <code>siege</code></div><div class="content"><pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">$ siege -c 200 -r 100 http://localhost:5050/
...
HTTP/1.1 200     0.01 secs:      53 bytes ==&gt; GET  /
HTTP/1.1 200     0.01 secs:      53 bytes ==&gt; GET  /
HTTP/1.1 200     0.00 secs:      53 bytes ==&gt; GET  /

Transactions:		       20000 hits
Availability:		      100.00 %
Elapsed time:		        3.86 secs
Data transferred:	        1.01 MB
Response time:		        0.03 secs
Transaction rate:	     5181.35 trans/sec
Throughput:		        0.26 MB/sec
Concurrency:		      152.01
Successful transactions:       20000
Failed transactions:	           0
Longest transaction:	        3.09
Shortest transaction:	        0.01</code></pre></div></div><div class="paragraph"><p>This time the garbage collector was much more active - here is the console log generated while the application was handling 20k requests:</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">$ ./ratpack-graalvm-demo -XX:+PrintGC -XX:+PrintGCTimeStamps -XX:+VerboseGC +XX:+PrintHeapShape -Xmx64m
[main] INFO ratpack.server.RatpackServer - Starting server...
[main] INFO ratpack.server.RatpackServer - Building registry...
[main] INFO ratpack.server.RatpackServer - Ratpack started for http://localhost:5050
[Heap policy parameters:
  YoungGenerationSize: 6710880
      MaximumHeapSize: 67108864
      MinimumHeapSize: 13421760
     AlignedChunkSize: 1048576
  LargeArrayThreshold: 131072]
[[1768 msec:  GC: before  epoch: 1  cause: CollectOnAllocation.Sometimes]
[1772 msec: Incremental GC (CollectOnAllocation.Sometimes) 20463K-&gt;17403K, 0.0040444 secs]
 [1772 msec:  GC: after   epoch: 1  cause: CollectOnAllocation.Sometimes  policy: by time: 50% in incremental collections  type: incremental
  collection time: 4044472 nanoSeconds]]
[[1845 msec:  GC: before  epoch: 2  cause: CollectOnAllocation.Sometimes]
[1850 msec: Full GC (CollectOnAllocation.Sometimes) 24543K-&gt;17403K, 0.0049823 secs]
 [1850 msec:  GC: after   epoch: 2  cause: CollectOnAllocation.Sometimes  policy: by time: 50% in incremental collections  type: complete
  collection time: 4982361 nanoSeconds]]

### [removed 200 lines for a better readability] ###

[[5479 msec:  GC: before  epoch: 53  cause: CollectOnAllocation.Sometimes]
[5483 msec: Full GC (CollectOnAllocation.Sometimes) 24543K-&gt;17403K, 0.0042101 secs]
 [5483 msec:  GC: after   epoch: 53  cause: CollectOnAllocation.Sometimes  policy: by time: 50% in incremental collections  type: complete
  collection time: 4210195 nanoSeconds]]
[[5549 msec:  GC: before  epoch: 54  cause: CollectOnAllocation.Sometimes]
[5551 msec: Incremental GC (CollectOnAllocation.Sometimes) 24543K-&gt;17403K, 0.0022523 secs]
 [5551 msec:  GC: after   epoch: 54  cause: CollectOnAllocation.Sometimes  policy: by time: 50% in incremental collections  type: incremental
  collection time: 2252302 nanoSeconds]]</code></pre></div></div><div class="paragraph"><p>And now let&#8217;s take a look at the memory consumption.</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">$ ps ef -o command,vsize,rss,%mem,size | grep ratpack | head -n 1
 \_ ./ratpack-graalvm-demo  281188 35812  0.2 62592</code></pre></div></div><div class="paragraph"><p>We could expect that. The application run with much smaller maximum heap size consumed <strong>eight times</strong> less memory - <strong>35 MB</strong> in this case.</p></div></div></div><div class="sect1"><h2 id="what-is-the-right-size">What is the right size?</h2><div class="sectionbody"><div class="paragraph"><p>It depends. You need to experiment with the optimal settings for your application. The good news is that you can compile the native image once and run tests with different settings without recompiling the image. I&#8217;ve run several tests with my demo Ratpack application, and I was able to limit max heap size to <strong>32 MB</strong>. However, if I kept the default size of the even loop group <em>(16 in my case)</em>, then I couldn&#8217;t get lower than <strong>256 MB</strong>. Otherwise, the application pretty quickly started crashing with <code>OutOfMemoryError</code>.</p></div></div></div><div id="footnotes"><hr><div class="footnote" id="_footnotedef_1"><a href="#_footnoteref_1">1</a>. <a target="_blank" rel="noopener" href="https://github.com/JoeDog/siege" class="bare">https://github.com/JoeDog/siege</a></div></div></div><ul class="tags-list mt-4"><li><a href="/t/java/">java</a></li><li><a href="/t/ratpack/">ratpack</a></li><li><a href="/t/graalvm/">graalvm</a></li><li><a href="/t/xmx/">xmx</a></li></ul></article></div></div></div></div></section><section class="bg-dark posts-layout-01" id="related" data-debug="Scrolled to related posts"><div class="container py-5"><div class="row py-lg-5"><div class="col-12 col-lg-7 d-flex align-items-start mb-lg-0 mb-4"><div class="px-3 px-lg-0 pr-lg-5"><article><a href="/spock-random-order-of-tests-how-to/"><img class="mb-4 shadow" data-lazy="/images/cards/35.png" width="100%"></a><p class="subtitle m-0"><a href="/groovy-cookbook/">Groovy Cookbook</a></p><h3 class="m-0 serif"><a href="/spock-random-order-of-tests-how-to/">Spock random order of tests - how to?</a></h3><div class="post-meta mb-4"><ul><li><time datetime="2019-04-06T08:52:11.000Z">April 6, 2019</time></li><li>6 min. read</li><li><a href="https://e.printstacktrace.blog/spock-random-order-of-tests-how-to/#disqus_thread">0 Comments</a></li></ul></div><p class="small">Spock Framework executes test methods (features) in a single class (specification) in the declaration order. There is nothing wrong in this default behavior - we should write tests with their isolation in mind. However, in some cases, we would like to randomize test methods execution. Today we are going to learn how to do it.</p></article></div></div><div class="col-12 col-lg-5"><div class="px-3 px-lg-0"><article class="tile"><div class="row mb-4"><div class="col-9"><p class="subtitle m-0"><a href="/ratpack-cookbook/">Ratpack Cookbook</a></p><h4 class="m-0 serif"><a href="/ratpack-graalvm-how-to-start/">Ratpack on GraalVM - how to start?</a></h4><div class="post-meta mb-4"><ul><li><time datetime="2019-02-15T02:10:39.000Z">February 15, 2019</time></li><li>6 min. read</li><li><a href="https://e.printstacktrace.blog/ratpack-graalvm-how-to-start/#disqus_thread">0 Comments</a></li></ul></div><p class="small">The journey inside the exciting world of GraalVM continues. Today I would like to share with you...</p></div><div class="col-3"><a href="/ratpack-graalvm-how-to-start/"><img class="img-fluid rounded shadow-sm mt-3 mb-lg-0" data-lazy="/images/icons/40.png"></a></div></div></article><article class="tile"><div class="row mb-4"><div class="col-9"><p class="subtitle m-0"><a href="/groovy-cookbook/">Groovy Cookbook</a></p><h4 class="m-0 serif"><a href="/graalvm-native-image-inside-docker-container-does-it-make-sense/">GraalVM native image inside docker container - does it make sense?</a></h4><div class="post-meta mb-4"><ul><li><time datetime="2019-01-19T12:19:22.000Z">January 19, 2019</time></li><li>6 min. read</li><li><a href="https://e.printstacktrace.blog/graalvm-native-image-inside-docker-container-does-it-make-sense/#disqus_thread">0 Comments</a></li></ul></div><p class="small">We have learned how to create GraalVM native image from standalone Groovy script in the previous...</p></div><div class="col-3"><a href="/graalvm-native-image-inside-docker-container-does-it-make-sense/"><img class="img-fluid rounded shadow-sm mt-3 mb-lg-0" data-lazy="/images/icons/24.png"></a></div></div></article><article class="tile"><div class="row mb-4"><div class="col-9"><p class="subtitle m-0"><a href="/learning-java/">Learning Java</a></p><h4 class="m-0 serif"><a href="/installing-graalvm-ee-1-0-0-rc14-with-sdkman/">Installing GraalVM EE 1.0.0-RC14 with SDKMAN!</a></h4><div class="post-meta mb-4"><ul><li><time datetime="2019-03-20T09:15:56.000Z">March 20, 2019</time></li><li>6 min. read</li><li><a href="https://e.printstacktrace.blog/installing-graalvm-ee-1-0-0-rc14-with-sdkman/#disqus_thread">0 Comments</a></li></ul></div><p class="small">I love SDKMAN!. It made using multiple different Java distributions in a single operating system...</p></div><div class="col-3"><a href="/installing-graalvm-ee-1-0-0-rc14-with-sdkman/"><img class="img-fluid rounded shadow-sm mt-3 mb-lg-0" data-lazy="/images/icons/27.png"></a></div></div></article><a class="gatr" href="https://click.linksynergy.com/fs-bin/click?id=uow2LCEuhvQ&amp;offerid=572706.11&amp;type=3&amp;subid=0" data-type="banner" data-name="nordvpn-03" target="_blank"><img class="img-fluid" data-lazy="/images/yml/nord-vpn-03.png"></a></div></div></div></div></section><section class="sidebar-enabled" id="comments" data-debug="Scrolled to comments"><div class="container"><div class="row"><div class="col-12 col-lg-3 sidebar order-lg-1 order-0"><div class="py-lg-5 py-3 position-sticky text-center" style="top:20px"><div class="d-inline-block d-lg-none"><a class="gatr" href="https://www.jdoqocy.com/click-100191173-10952823" data-type="banner" data-name="grammarly-02" target="_blank"><img class="img-fluid" data-lazy="/images/yml/grammarly-02.png"></a></div><div class="d-none d-lg-inline-block"><a class="gatr" href="https://www.jdoqocy.com/click-100191173-10952823" data-type="banner" data-name="grammarly-01" target="_blank"><img class="img-fluid" data-lazy="/images/yml/grammarly-tower.png"></a></div></div></div><div class="col-12 col-lg-9 order-0 order-lg-0 order-1"><div class="pr-lg-5 py-5"><p class="m-0 serif small text-muted">Any thoughts or ideas?</p><h2 class="mb-4">Let's talk in the comment's section üí¨</h2><div class="disqus-comments"><div class="tip mb-5">Want to put a code sample in the comment? Read the <a target="_blank" rel="noopener" href="https://help.disqus.com/en/articles/1717236-syntax-highlighting"><b>Syntax highlighting</b></a> guide for more information.</div><div class="comments"><div id="disqus_thread"><div id="disqus_empty" style="display:none">Empty</div></div></div></div><script>function load_disqus(e){var t=document.getElementById("disqus_empty");if(document.contains(t)){var d=document.getElementById("disqus_thread"),n=document.createElement("script"),s=document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0];d&&t&&(t.remove(),n.type="text/javascript",n.async=!0,n.src="//"+e+".disqus.com/embed.js",s.appendChild(n))}}window.addEventListener("scroll",function(e){document.scrollingElement.scrollTop>document.getElementById("disqus_thread").offsetTop-500&&load_disqus("eprintstacktrace")},!1)</script></div></div></div></div></section></main><footer class="bg-dark" id="footer" data-debug="Scrolled to footer"><div class="container py-5"><div class="px-lg-0 px-3"><div class="row py-lg-3"><div class="col-12 col-md-6"><h5 class="mb-4">Latest blog posts</h5><ul class="list-unstyled mb-5"><li><a href="/merging-json-files-recursively-in-the-command-line/">Merging JSON files recursively in the command-line</a></li><li><a href="/jenkins-declarative-pipeline-dynamic-agent/">Jenkins Declarative Pipeline with the dynamic agent - how to configure it?</a></li><li><a href="/groovy-ecosystem-usage-report-2020/">Groovy Ecosystem Usage Report (2020)</a></li><li><a href="/how-to-convert-json-to-csv-from-the-command-line/">How to convert JSON to CSV from the command-line?</a></li><li><a href="/5-common-jenkins-pipeline-mistakes/">5 Common Jenkins Pipeline Mistakes</a></li><li><a href="/how-to-merge-two-maps-in-groovy/">How to merge two maps in Groovy?</a></li><li><a href="/building-stackoverflow-cli-with-java-11-micronaut-picocli-and-graalvm/">Building stackoverflow-cli with Java 11, Micronaut, Picocli, and GraalVM</a></li><li><a href="/how-to-catch-curl-response-in-jenkins-pipeline/">How to catch curl response in Jenkins Pipeline?</a></li><li><a href="/atomic-habits-book-review/">Atomic Habits - book review</a></li><li><a href="/parsing-json-in-command-line-with-jq-basic-filters-and-functions-part-1/">Parsing JSON in command-line with jq: basic filters and functions (part 1)</a></li></ul></div><div class="col-12 col-md-6"><h5 class="mb-4">Trending videos</h5><div class="youtube-row mb-4"><div class="row"><div class="col-12 col-lg-6 text-lg-left text-center mb-lg-0 mb-4"><a class="d-inline-block thumb gatr" target="_blank" rel="noopener" href="https://youtu.be/Ei_Nk14vruE" data-type="youtube" data-name="Jenkins Declarative Pipeline vs Scripted Pipeline - 4 key differences | #jenkinspipeline" data-time="13:45"><img class="img-fluid shadow" data-lazy="https://i3.ytimg.com/vi/Ei_Nk14vruE/mqdefault.jpg"></a></div><div class="col-12 col-lg-6"><h6 class="m-0 p-0 mb-3 sans-serif text-lg-left text-center px-lg-0 px-4"><a class="gatr" target="_blank" rel="noopener" href="https://youtu.be/Ei_Nk14vruE" data-type="youtube" data-name="Jenkins Declarative Pipeline vs Scripted Pipeline - 4 key differences | #jenkinspipeline">Jenkins Declarative Pipeline vs Scripted Pipeline - 4 key differences | #jenkinspipeline</a></h6><p class="sans-serif small text-justify">Jenkins Pipeline as a code is a new standard for defining continuous integration and delivery pipelines in Jenkins. The scrip...</p></div></div></div><div class="youtube-row mb-4"><div class="row"><div class="col-12 col-lg-6 text-lg-left text-center mb-lg-0 mb-4"><a class="d-inline-block thumb gatr" target="_blank" rel="noopener" href="https://youtu.be/KwQDxwZRZiE" data-type="youtube" data-name="Jenkins Pipeline Environment Variables explained | #jenkinspipeline" data-time="16:43"><img class="img-fluid shadow" data-lazy="https://i3.ytimg.com/vi/KwQDxwZRZiE/mqdefault.jpg"></a></div><div class="col-12 col-lg-6"><h6 class="m-0 p-0 mb-3 sans-serif text-lg-left text-center px-lg-0 px-4"><a class="gatr" target="_blank" rel="noopener" href="https://youtu.be/KwQDxwZRZiE" data-type="youtube" data-name="Jenkins Pipeline Environment Variables explained | #jenkinspipeline">Jenkins Pipeline Environment Variables explained | #jenkinspipeline</a></h6><p class="sans-serif small text-justify">In today's video, I show you how you can work effectively with environment variables in the Jenkins pipeline as a code. You w...</p></div></div></div></div></div><div class="row text-lg-left text-center"><div class="col-12 col-md-3 mb-lg-0 mb-4"><h5 class="mb-4">Useful links</h5><ul class="list-unstyled"><li><a class="gatr" href="/" data-type="footer-useful-links" data-name="Start here">Start here</a></li><li><a class="gatr" href="/about" data-type="footer-useful-links" data-name="About">About</a></li><li><a class="gatr" href="/archives" data-type="footer-useful-links" data-name="Archives">Archives</a></li><li><a class="gatr" href="/resources" data-type="footer-useful-links" data-name="Resources">Resources</a></li><li><a class="gatr" href="/privacy-policy" data-type="footer-useful-links" data-name="Privacy Policy">Privacy Policy</a></li><li><a class="gatr" target="_blank" rel="noopener" href="https://teespring.com/stores/eprintstacktrace" data-type="footer-useful-links" data-name="Merchandise">Merchandise</a></li><li><a class="gatr" target="_blank" rel="noopener" href="https://kit.co/wololock" data-type="footer-useful-links" data-name="My Kit">My Kit</a></li><li><a class="gatr" target="_blank" rel="noopener" href="https://feeds.feedburner.com/Eprintstacktracenet" data-type="footer-useful-links" data-name="RSS">RSS</a></li><li><a class="gatr" href="/support-me" data-type="footer-useful-links" data-name="Support me">Support the blog <em class="fas fa-heart color-red ml-2"></em></a></li></ul></div><div class="col-12 col-md-3 mb-lg-0 mb-4"><h5 class="mb-4">Popular categories</h5><ul class="list-unstyled"><li><a class="gatr" href="/groovy-cookbook/" data-type="footer-category" data-name="Groovy Cookbook">Groovy Cookbook<span class="count ml-2 text-muted">28</span></a></li><li><a class="gatr" href="/jenkins-pipeline-cookbook/" data-type="footer-category" data-name="Jenkins Pipeline Cookbook">Jenkins Pipeline Cookbook<span class="count ml-2 text-muted">9</span></a></li><li><a class="gatr" href="/programmers-bookshelf/" data-type="footer-category" data-name="Programmer's Bookshelf">Programmer's Bookshelf<span class="count ml-2 text-muted">6</span></a></li><li><a class="gatr" href="/micronaut-cookbook/" data-type="footer-category" data-name="Micronaut Cookbook">Micronaut Cookbook<span class="count ml-2 text-muted">4</span></a></li><li><a class="gatr" href="/ratpack-cookbook/" data-type="footer-category" data-name="Ratpack Cookbook">Ratpack Cookbook<span class="count ml-2 text-muted">4</span></a></li><li><a class="gatr" href="/learning-java/" data-type="footer-category" data-name="Learning Java">Learning Java<span class="count ml-2 text-muted">4</span></a></li><li><a class="gatr" href="/jq-cookbook/" data-type="footer-category" data-name="jq cookbook">jq cookbook<span class="count ml-2 text-muted">3</span></a></li><li><a class="gatr" href="/how-to/" data-type="footer-category" data-name="How to">How to<span class="count ml-2 text-muted">3</span></a></li><li><a class="gatr" href="/blog-reports/" data-type="footer-category" data-name="Blog Reports">Blog Reports<span class="count ml-2 text-muted">2</span></a></li></ul></div><div class="col-12 col-md-6"><h5 class="mb-4">Popular tags</h5><section class="tagcloud"><a href="/t/affiliate/" style="font-size:1.8em;color:#7b828b">affiliate</a> <a href="/t/async/" style="font-size:1.4em;color:#696f76">async</a> <a href="/t/benchmark/" style="font-size:1.6em;color:#727880">benchmark</a> <a href="/t/blogging/" style="font-size:1.2em;color:#60666b">blogging</a> <a href="/t/book/" style="font-size:2em;color:#848b95">book</a> <a href="/t/career/" style="font-size:1.2em;color:#60666b">career</a> <a href="/t/cicd/" style="font-size:2.4em;color:#969daa">cicd</a> <a href="/t/continuous-integration/" style="font-size:1.4em;color:#696f76">continuous-integration</a> <a href="/t/curl/" style="font-size:1.6em;color:#727880">curl</a> <a href="/t/devops/" style="font-size:2.2em;color:#8d94a0">devops</a> <a href="/t/docker/" style="font-size:1.6em;color:#727880">docker</a> <a href="/t/git/" style="font-size:1.2em;color:#60666b">git</a> <a href="/t/github/" style="font-size:1.4em;color:#696f76">github</a> <a href="/t/graalvm/" style="font-size:2.4em;color:#969daa">graalvm</a> <a href="/t/gradle/" style="font-size:1.2em;color:#60666b">gradle</a> <a href="/t/grails/" style="font-size:1.4em;color:#696f76">grails</a> <a href="/t/groovy/" style="font-size:3em;color:#b1b9ca">groovy</a> <a href="/t/haskell/" style="font-size:1.4em;color:#696f76">haskell</a> <a href="/t/hexo/" style="font-size:1.2em;color:#60666b">hexo</a> <a href="/t/java/" style="font-size:2.8em;color:#a8b0bf">java</a> <a href="/t/java-8/" style="font-size:1.4em;color:#696f76">java-8</a> <a href="/t/jenkins/" style="font-size:2.6em;color:#9fa7b5">jenkins</a> <a href="/t/jenkins-pipeline/" style="font-size:2.6em;color:#9fa7b5">jenkins-pipeline</a> <a href="/t/jenkinsfile/" style="font-size:1.4em;color:#696f76">jenkinsfile</a> <a href="/t/jmh/" style="font-size:1.8em;color:#7b828b">jmh</a> <a href="/t/jq/" style="font-size:1.6em;color:#727880">jq</a> <a href="/t/json/" style="font-size:1.6em;color:#727880">json</a> <a href="/t/junit/" style="font-size:1.4em;color:#696f76">junit</a> <a href="/t/learning/" style="font-size:1.6em;color:#727880">learning</a> <a href="/t/maven/" style="font-size:1.4em;color:#696f76">maven</a> <a href="/t/metaprogramming/" style="font-size:1.2em;color:#60666b">metaprogramming</a> <a href="/t/micronaut/" style="font-size:2em;color:#848b95">micronaut</a> <a href="/t/native-image/" style="font-size:1.8em;color:#7b828b">native-image</a> <a href="/t/non-blocking/" style="font-size:1.6em;color:#727880">non-blocking</a> <a href="/t/progress/" style="font-size:1.2em;color:#60666b">progress</a> <a href="/t/ratpack/" style="font-size:2.4em;color:#969daa">ratpack</a> <a href="/t/reactive-programming/" style="font-size:1.4em;color:#696f76">reactive-programming</a> <a href="/t/reading/" style="font-size:1.4em;color:#696f76">reading</a> <a href="/t/recursion/" style="font-size:1.4em;color:#696f76">recursion</a> <a href="/t/review/" style="font-size:2em;color:#848b95">review</a> <a href="/t/rxjava/" style="font-size:1.4em;color:#696f76">rxjava</a> <a href="/t/sdkman/" style="font-size:1.6em;color:#727880">sdkman</a> <a href="/t/session/" style="font-size:1.2em;color:#60666b">session</a> <a href="/t/split/" style="font-size:1.2em;color:#60666b">split</a> <a href="/t/spock/" style="font-size:1.6em;color:#727880">spock</a> <a href="/t/stackoverflow/" style="font-size:1.4em;color:#696f76">stackoverflow</a> <a href="/t/string/" style="font-size:1.4em;color:#696f76">string</a> <a href="/t/tail-call/" style="font-size:1.2em;color:#60666b">tail-call</a> <a href="/t/tail-recursion/" style="font-size:1.2em;color:#60666b">tail-recursion</a> <a href="/t/unit-test/" style="font-size:1.6em;color:#727880">unit-test</a></section></div></div></div></div><section class="bottom"><div class="container"><ul class="text-center py-1 m-0"><li class="d-inline-block">Designed by <a class="gatr" target="_blank" rel="noopener" href="https://twitter.com/wololock" data-type="footer" data-name="designed">@wololock</a></li><li class="d-inline-block">Created with <a class="gatr" target="_blank" rel="noopener" href="https://hexo.io" data-type="footer" data-name="hexo">Hexo</a></li><li class="d-inline-block">Hosted on <a class="gatr" target="_blank" rel="noopener" href="https://github.com/wololock/wololock.github.io" data-type="footer" data-name="github">GitHub</a></li><li class="d-inline-block">Deployed with <a class="gatr" target="_blank" rel="noopener" href="https://circleci.com/gh/wololock/wololock.github.io" data-type="footer" data-name="circleci">Circle CI</a></li><li class="d-inline-block">License <a class="gatr" target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/" data-type="footer" data-name="license">CC BY-NC-SA 4.0</a></li><li class="d-inline-block"><a class="gatr" target="_blank" rel="noopener" href="https://github.com/wololock/wololock.github.io/commits/develop" data-type="footer" data-name="last-commit"><img data-lazy="https://badgen.net/github/last-commit/wololock/wololock.github.io?color=blue&amp;scale=0.8"></a></li></ul></div></section></footer><script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script><script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/48c5da59c9.js" crossorigin="anonymous" async></script><script async id="cookiebanner" src="//cdnjs.cloudflare.com/ajax/libs/cookie-banner/1.2.2/cookiebanner.min.js" data-moreinfo="/privacy-policy/" data-message="This blog uses cookies to enhance your experience. By continuing to visit it you agree to its use of cookies." data-link="#5fc4ff" data-font-family="Lora,serif" data-font-size="16px" data-bg="#1d2b36"></script><script src="/js/main.js?v=11"></script><script src="/js/highlightjs/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad()</script><script async id="dsq-count-scr" src="//eprintstacktrace.disqus.com/count.js"></script><script>!function(e,t,a,c,n,i,r){e.GoogleAnalyticsObject=n,e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=1*new Date,i=t.createElement(a),r=t.getElementsByTagName(a)[0],i.async=1,i.src="//www.google-analytics.com/analytics.js",r.parentNode.insertBefore(i,r)}(window,document,"script",0,"ga"),ga("create","UA-42400890-5","auto"),ga("send","pageview"),jQuery(document).on("mousedown","a.gatr",function(e){var t=jQuery(this),a=t.attr("data-type"),c=t.attr("data-name"),n=1===e.which?"click":2===e.which?"middle-click":"right-click";return ga("send","event",a,n,c),!0}),jQuery(document).on("mousedown","#related a",function(e){var t=jQuery(this),a=1===e.which?"click":2===e.which?"middle-click":"right-click";return ga("send","event","related",a,t.attr("href")),!0}),jQuery(document).on("mousedown","#footer a",function(e){var t=jQuery(this),a=1===e.which?"click":2===e.which?"middle-click":"right-click";return ga("send","event","footer",a,t.attr("href")),!0})</script><script>!function(){"use strict";function r(e){var t=e.getAttribute("data-original"),n=new Image;n.onload=function(){e.setAttribute("src",t),e.style.paddingTop=""},n.src=t}document.addEventListener("DOMContentLoaded",function(){var t,e,n,i=Array.prototype.slice.call(document.querySelectorAll("img[data-original]"));i.length&&("undefined"!=typeof IntersectionObserver?(t=new IntersectionObserver(function(e,t){e.filter(function(e){return e.isIntersecting}).forEach(function(e){r(e.target),t.unobserve(e.target)})}),i.forEach(function(e){t.observe(e)})):(n=function(){clearTimeout(e),e=setTimeout(function(){return(i=i.filter(function(e){return!e.src})).length?void i.filter(function(e){e.getBoundingClientRect().top<window.innerHeight&&r(e)}):(window.removeEventListener("scroll",n),void window.removeEventListener("resize",n))},100)},window.addEventListener("scroll",n),window.addEventListener("resize",n),n()))},!1)}();</script></body></html>