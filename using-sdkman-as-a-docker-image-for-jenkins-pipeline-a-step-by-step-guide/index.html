<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name="robots" content="all"><meta name="ir-site-verification-token" value="626123791"><title>Using SDKMAN! as a docker image for Jenkins Pipeline - a step by step guide</title><meta name="keywords" content="java,groovy,docker,sdkman,devops,jenkins,jenkins-pipeline,cicd,maven"><link rel="dns-prefetch" href="//fonts.googleapis.com"><link rel="dns-prefetch" href="//cdnjs.cloudflare.com"><link rel="dns-prefetch" href="//stackpath.bootstrapcdn.com"><link rel="shortcut icon" type="image/png" href="/favicon_new.png"><link rel="canonical" href="https://e.printstacktrace.blog/using-sdkman-as-a-docker-image-for-jenkins-pipeline-a-step-by-step-guide/"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Code+Pro:wght@400;500;700|Poppins:300,400,400i,700|Montserrat:400,600,700|Roboto:300,400,400i,700|Lora:400,400i,700,700i&amp;display=swap"><link rel="stylesheet" href="//stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous"><link rel="stylesheet" href="/css/main.css?v=71"><link rel="stylesheet" href="/css/highlight.css?v=71"><meta name="description" content="A few days ago, I was struggling with some Docker images I use in my Jenkins CI environment. I run some Jenkins Pipelines, and I like to define build environment as code using custom Docker images. E"><meta property="og:type" content="article"><meta property="og:title" content="Using SDKMAN! as a docker image for Jenkins Pipeline - a step by step guide"><meta property="og:url" content="https://e.printstacktrace.blog/using-sdkman-as-a-docker-image-for-jenkins-pipeline-a-step-by-step-guide/"><meta property="og:site_name" content="e.printstacktrace.blog - I help you become a better software developer."><meta property="og:description" content="A few days ago, I was struggling with some Docker images I use in my Jenkins CI environment. I run some Jenkins Pipelines, and I like to define build environment as code using custom Docker images. E"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://e.printstacktrace.blog/images/cards/3.png"><meta property="article:published_time" content="2019-11-06T18:34:01.000Z"><meta property="article:modified_time" content="2019-11-06T18:34:01.000Z"><meta property="article:author" content="Szymon Stepniak"><meta property="article:tag" content="java"><meta property="article:tag" content="groovy"><meta property="article:tag" content="docker"><meta property="article:tag" content="sdkman"><meta property="article:tag" content="devops"><meta property="article:tag" content="jenkins"><meta property="article:tag" content="jenkins-pipeline"><meta property="article:tag" content="cicd"><meta property="article:tag" content="maven"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image" content="https://e.printstacktrace.blog/images/cards/3.png"><meta name="twitter:creator" content="@wololock"><script type="application/ld+json">{"@context":"https://schema.org","@graph":[{"@type":["Person","Organization"],"@id":"https://e.printstacktrace.blog/#/schema/person/wololock","name":"Szymon Stepniak","description":"I help you become a better software developer.","image":{"@type":"ImageObject","@id":"https://e.printstacktrace.blog/#avatar","inLanguage":"en-US","url":"https://www.gravatar.com/avatar/b22c1842c6e8f7f2b9b3ed8c0d4efb4d?s=200","caption":"Szymon Stepniak"},"logo":{"@id":"https://e.printstacktrace.blog/#avatar"},"sameAs":["https://twitter.com/wololock","https://github.com/wololock","https://stackoverflow.com/users/2194470/szymon-stepniak","https://www.youtube.com/c/eprintstacktrace"]},{"@type":"WebSite","@id":"https://e.printstacktrace.blog/#website","url":"https://e.printstacktrace.blog","name":"e.printstacktrace.blog - I help you become a better software developer.","description":"Blog about programming, created by Upwork's Top Rated freelancer, 10+ years experienced Java/Groovy developer. Contact me if you are looking for an experienced and high quality consultant."},{"@type":"WebPage","@id":"https://e.printstacktrace.blog/using-sdkman-as-a-docker-image-for-jenkins-pipeline-a-step-by-step-guide/#webpage","url":"https://e.printstacktrace.blog/using-sdkman-as-a-docker-image-for-jenkins-pipeline-a-step-by-step-guide/","name":"Using SDKMAN! as a docker image for Jenkins Pipeline - a step by step guide","isPartOf":{"@id":"https://e.printstacktrace.blog/#website"},"datePublished":"2019-11-06T18:34:01.000Z","dateModified":"2019-11-06T18:34:01.000Z","description":"\nA few days ago, I was struggling with some Docker images I use in my Jenkins CI environment.\nI run some Jenkins Pipelines, and I like to define build environment as code using custom Docker images.\nEverything was fine until I had to consider running different Java or Maven versions.\nI decided to use one of my favorite command-line tools - SDKMAN!, to build a highly configurable build environment.\n","inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://e.printstacktrace.blog/using-sdkman-as-a-docker-image-for-jenkins-pipeline-a-step-by-step-guide/"]}]},{"@type":"Article","@id":"https://e.printstacktrace.blog/using-sdkman-as-a-docker-image-for-jenkins-pipeline-a-step-by-step-guide/#article","isPartOf":{"@id":"https://e.printstacktrace.blog/using-sdkman-as-a-docker-image-for-jenkins-pipeline-a-step-by-step-guide/#webpage"},"author":{"@id":"https://e.printstacktrace.blog/#/schema/person/wololock"},"headline":"Using SDKMAN! as a docker image for Jenkins Pipeline - a step by step guide","datePublished":"2019-11-06T18:34:01.000Z","dateModified":"2019-11-06T18:34:01.000Z","mainEntityOfPage":{"@id":"https://e.printstacktrace.blog/using-sdkman-as-a-docker-image-for-jenkins-pipeline-a-step-by-step-guide/#webpage"},"publisher":{"@id":"https://e.printstacktrace.blog/#/schema/person/wololock"},"keywords":"java,groovy,docker,sdkman,devops,jenkins,jenkins-pipeline,cicd,maven","image":{"@type":"ImageObject","@id":"https://e.printstacktrace.blog/using-sdkman-as-a-docker-image-for-jenkins-pipeline-a-step-by-step-guide/#primaryimage","url":"https://e.printstacktrace.blog/images/cards/3.png","inLanguage":"en-US","caption":"Using SDKMAN! as a docker image for Jenkins Pipeline - a step by step guide"},"inLanguage":"en-US"},{"@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"https://e.printstacktrace.blog"},{"@type":"ListItem","position":2,"name":"Jenkins Pipeline Cookbook","item":"https://e.printstacktrace.blog/jenkins-pipeline-cookbook/"},{"@type":"ListItem","position":3,"name":"Using SDKMAN! as a docker image for Jenkins Pipeline - a step by step guide"}]}]}</script><meta name="generator" content="Hexo 5.2.0"><link rel="alternate" href="/atom.xml" title="e.printstacktrace.blog - I help you become a better software developer." type="application/atom+xml">
<style>.img-lazyload-container{overflow:hidden;max-width:100%}.img-lazyload-container img{max-width:100%;display:block;height:auto;transition:opacity .5s ease-in-out}.img-lazyload-container img:not([src]){height:0;opacity:0}</style></head><body><header class="fixed-top" id="header"><div class="container"><nav class="navbar navbar-light mx-0 px-0 justify-content-start"><a class="gatr" href="/" data-type="nav" data-name="Home">Home</a><a class="gatr" href="/about" data-type="nav" data-name="About">About</a><a class="gatr" href="/archives" data-type="nav" data-name="Archives">Archives</a><a class="gatr" href="/resources" data-type="nav" data-name="Tools &amp; Resources">Tools & Resources</a><a class="gatr" href="/support-me" data-type="nav" data-name="Support me">Support me</a></nav></div></header><main id="main"><section class="sidebar-enabled" id="content"><div class="container"><div class="row"><div class="col-lg-3 bg-primary sidebar pt-5 d-flex align-items-start flex-column order-1 pr-lg-0"><div class="mb-auto"><div class="text-center pt-lg-5 pl-3"><a href="/about"><img class="rounded-circle mb-4" src="https://www.gravatar.com/avatar/b22c1842c6e8f7f2b9b3ed8c0d4efb4d?s=200" height="96"></a><h5>Hi! üëã I'm Szymon</h5><p class="small">I help you become a better software developer.</p></div><div class="my-4 pl-2 text-lg-right text-center"><ul class="social-media"><li><a class="gatr" target="_blank" rel="noopener" href="https://twitter.com/wololock" data-type="social-media" data-name="Twitter" title="Twitter"><i class="fa fa-twitter"></i><span class="number">1.14k</span><span class="description">Followers</span></a></li><li><a class="gatr" target="_blank" rel="noopener" href="https://www.youtube.com/eprintstacktrace" data-type="social-media" data-name="YouTube" title="YouTube"><i class="fa fa-youtube"></i><span class="number">2.25k</span><span class="description">Subscribers</span></a></li><li><a class="gatr" target="_blank" rel="noopener" href="https://github.com/wololock" data-type="social-media" data-name="Github" title="Github"><i class="fa fa-github"></i><span class="number">108</span><span class="description">Followers</span></a></li><li><a class="gatr" target="_blank" rel="noopener" href="https://stackoverflow.com/users/2194470/szymon-stepniak?tab=profile" data-type="social-media" data-name="StackOverflow" title="StackOverflow"><i class="fa fa-stack-overflow"></i><span class="number">30.1k</span><span class="description">Reputation</span></a></li></ul></div><div class="pl-4 mt-lg-5 pt-lg-2"><h4 class="h4 pt-4 mb-4 sans-serif">Latest posts from the <span class="h3 font-weight-bold">Jenkins Pipeline Cookbook</span></h4><div class="media align-items-center pb-1 mb-3"><a class="d-block gatr" href="/jenkins-declarative-pipeline-dynamic-agent/" data-type="latest-sidebar" data-name="Jenkins Declarative Pipeline with the dynamic agent - how to configure it?"><img class="rounded" src="/images/icons/50.png" width="64"></a><div class="media-body pl-2 ml-1"><h5 class="m-0 small" style="font-size:14px;font-weight:600;line-height:22px"><a class="sans-serif gatr" href="/jenkins-declarative-pipeline-dynamic-agent/" data-type="latest-sidebar" data-name="Jenkins Declarative Pipeline with the dynamic agent - how to configure it?">Jenkins Declarative Pipeline with the dynamic agent - how to ...</a></h5></div></div><div class="media align-items-center pb-1 mb-3"><a class="d-block gatr" href="/5-common-jenkins-pipeline-mistakes/" data-type="latest-sidebar" data-name="5 Common Jenkins Pipeline Mistakes"><img class="rounded" src="/images/icons/1.png" width="64"></a><div class="media-body pl-2 ml-1"><h5 class="m-0 small" style="font-size:14px;font-weight:600;line-height:22px"><a class="sans-serif gatr" href="/5-common-jenkins-pipeline-mistakes/" data-type="latest-sidebar" data-name="5 Common Jenkins Pipeline Mistakes">5 Common Jenkins Pipeline Mistakes</a></h5></div></div><div class="media align-items-center pb-1 mb-3"><a class="d-block gatr" href="/how-to-catch-curl-response-in-jenkins-pipeline/" data-type="latest-sidebar" data-name="How to catch curl response in Jenkins Pipeline?"><img class="rounded" src="/images/icons/48.png" width="64"></a><div class="media-body pl-2 ml-1"><h5 class="m-0 small" style="font-size:14px;font-weight:600;line-height:22px"><a class="sans-serif gatr" href="/how-to-catch-curl-response-in-jenkins-pipeline/" data-type="latest-sidebar" data-name="How to catch curl response in Jenkins Pipeline?">How to catch curl response in Jenkins Pipeline?</a></h5></div></div><div class="media align-items-center pb-1 mb-3"><a class="d-block gatr" href="/how-to-time-out-jenkins-pipeline-stage-and-keep-the-pipeline-running/" data-type="latest-sidebar" data-name="How to time out Jenkins Pipeline stage and keep the pipeline running?"><img class="rounded" src="/images/icons/2.png" width="64"></a><div class="media-body pl-2 ml-1"><h5 class="m-0 small" style="font-size:14px;font-weight:600;line-height:22px"><a class="sans-serif gatr" href="/how-to-time-out-jenkins-pipeline-stage-and-keep-the-pipeline-running/" data-type="latest-sidebar" data-name="How to time out Jenkins Pipeline stage and keep the pipeline running?">How to time out Jenkins Pipeline stage and keep the pipeline ...</a></h5></div></div><div class="media align-items-center pb-1 mb-3"><a class="d-block gatr" href="/jenkins-scripted-pipeline-vs-declarative-pipeline-the-4-practical-differences/" data-type="latest-sidebar" data-name="Jenkins Scripted Pipeline vs. Declarative Pipeline - the 4 practical differences"><img class="rounded" src="/images/icons/13.png" width="64"></a><div class="media-body pl-2 ml-1"><h5 class="m-0 small" style="font-size:14px;font-weight:600;line-height:22px"><a class="sans-serif gatr" href="/jenkins-scripted-pipeline-vs-declarative-pipeline-the-4-practical-differences/" data-type="latest-sidebar" data-name="Jenkins Scripted Pipeline vs. Declarative Pipeline - the 4 practical differences">Jenkins Scripted Pipeline vs. Declarative Pipeline - the 4 pr...</a></h5></div></div><div class="media align-items-center pb-1 mb-3"><a class="d-block gatr" href="/using-jenkins-pipeline-parallel-stages-to-build-maven-project-with-different-jdks/" data-type="latest-sidebar" data-name="Using Jenkins Pipeline parallel stages to build Maven project with different JDKs"><img class="rounded" src="/images/icons/16.png" width="64"></a><div class="media-body pl-2 ml-1"><h5 class="m-0 small" style="font-size:14px;font-weight:600;line-height:22px"><a class="sans-serif gatr" href="/using-jenkins-pipeline-parallel-stages-to-build-maven-project-with-different-jdks/" data-type="latest-sidebar" data-name="Using Jenkins Pipeline parallel stages to build Maven project with different JDKs">Using Jenkins Pipeline parallel stages to build Maven project...</a></h5></div></div><div class="media align-items-center pb-1 mb-3"><a class="d-block gatr" href="/building-java-and-maven-docker-images-using-parallelized-jenkins-pipeline-and-sdkman/" data-type="latest-sidebar" data-name="Building Java and Maven docker images using parallelized Jenkins Pipeline and SDKMAN!"><img class="rounded" src="/images/icons/19.png" width="64"></a><div class="media-body pl-2 ml-1"><h5 class="m-0 small" style="font-size:14px;font-weight:600;line-height:22px"><a class="sans-serif gatr" href="/building-java-and-maven-docker-images-using-parallelized-jenkins-pipeline-and-sdkman/" data-type="latest-sidebar" data-name="Building Java and Maven docker images using parallelized Jenkins Pipeline and SDKMAN!">Building Java and Maven docker images using parallelized Jenk...</a></h5></div></div><div class="text-center"><a class="view-all" href="/jenkins-pipeline-cookbook/" data-type="latest-sidebar" data-name="More &amp;raquo;"><span class="d-block m-0">More</span><i class="fas fa-chevron-down d-block m-0"></i></a></div></div><div class="pl-4 mt-5"><h4 class="mb-3">Popular categories</h4><ul class="list-unstyled"><li class="my-1"><a class="gatr" href="/groovy-cookbook/" data-type="sidebar-category" data-name="Groovy Cookbook">Groovy Cookbook<span class="count ml-2 mark">28</span></a></li><li class="my-1"><a class="gatr" href="/jenkins-pipeline-cookbook/" data-type="sidebar-category" data-name="Jenkins Pipeline Cookbook">Jenkins Pipeline Cookbook<span class="count ml-2 mark">9</span></a></li><li class="my-1"><a class="gatr" href="/programmers-bookshelf/" data-type="sidebar-category" data-name="Programmer's Bookshelf">Programmer's Bookshelf<span class="count ml-2 mark">6</span></a></li><li class="my-1"><a class="gatr" href="/micronaut-cookbook/" data-type="sidebar-category" data-name="Micronaut Cookbook">Micronaut Cookbook<span class="count ml-2 mark">4</span></a></li><li class="my-1"><a class="gatr" href="/ratpack-cookbook/" data-type="sidebar-category" data-name="Ratpack Cookbook">Ratpack Cookbook<span class="count ml-2 mark">4</span></a></li><li class="my-1"><a class="gatr" href="/learning-java/" data-type="sidebar-category" data-name="Learning Java">Learning Java<span class="count ml-2 mark">4</span></a></li><li class="my-1"><a class="gatr" href="/jq-cookbook/" data-type="sidebar-category" data-name="jq cookbook">jq cookbook<span class="count ml-2 mark">3</span></a></li><li class="my-1"><a class="gatr" href="/how-to/" data-type="sidebar-category" data-name="How to">How to<span class="count ml-2 mark">3</span></a></li><li class="my-1"><a class="gatr" href="/blog-reports/" data-type="sidebar-category" data-name="Blog Reports">Blog Reports<span class="count ml-2 mark">2</span></a></li></ul></div><div class="text-center"><div class="d-none d-lg-inline-block mb-5 pt-5"><a class="gatr" href="https://e.printstacktrace.blog/bluehost" data-type="banner" data-name="bluehost-02" target="_blank"><img class="img-fluid" data-lazy="/images/yml/bluehost-02.png"></a></div><div class="d-inline-block d-lg-none py-3"><a class="gatr" href="https://click.linksynergy.com/fs-bin/click?id=uow2LCEuhvQ&amp;offerid=507388.13486&amp;subid=0&amp;type=4" data-type="banner" data-name="udemy-01" target="_blank"><img class="img-fluid" data-lazy="/images/yml/udemy-01.png"></a></div></div></div><div class="spread-the-love pt-4 mt-lg-5"><div class="mb-lg-5 pb-5 pl-lg-4"><h3 class="mb-3">Don't miss anything - join my newsletter</h3><p class="text-justify">Additional materials and updates for subscribers. <b>No spam guaranteed</b>.<br>Unsubscribe at any time.</p><div id="ck-5bc70426c4-box"></div><script>function load_newsletter(e){var t=document.getElementById("ck-5bc70426c4-box");if(document.contains(t)){var n=t.parentElement;t.remove();var o=document.createElement("script");o.type="text/javascript",o.async=!0,o.src="https://tremendous-motivator-1432.ck.page/"+e+"/index.js",o.setAttribute("data-uid",e),n.appendChild(o),console.log("Convertkit "+e+" loaded.")}}window.addEventListener("scroll",(function(e){var t=document.scrollingElement.scrollTop,n=document.getElementById("ck-5bc70426c4-box");document.contains(n)&&t>n.getBoundingClientRect().top- -500&&load_newsletter("5bc70426c4")}))</script></div><div class="pl-lg-3 text-lg-left text-center"><p class="m-0 serif">Did you like this article?</p><h5 class="text-uppercase">Spread the <i class="fa fa-heart"></i>!</h5><ul class="mb-5"><li><a class="gatr" target="_blank" rel="noopener" href="https://twitter.com/intent/tweet?text=Using SDKMAN! as a docker image for Jenkins Pipeline - a step by step guide https://e.printstacktrace.blog/using-sdkman-as-a-docker-image-for-jenkins-pipeline-a-step-by-step-guide/ via @wololock" data-type="share" data-name="Shared on Twitter"><i class="fa fa-twitter"></i></a></li><li><a class="gatr" target="_blank" rel="noopener" href="https://www.linkedin.com/shareArticle?url=https://e.printstacktrace.blog/using-sdkman-as-a-docker-image-for-jenkins-pipeline-a-step-by-step-guide/" data-type="share" data-name="Shared on LinkedIn"><i class="fa fa-linkedin"></i></a></li><li><a class="gatr" target="_blank" rel="noopener" href="https://www.facebook.com/sharer.php?u=https://e.printstacktrace.blog/using-sdkman-as-a-docker-image-for-jenkins-pipeline-a-step-by-step-guide/" data-type="share" data-name="Shared on Facebook"><i class="fa fa-facebook-square"></i></a></li><li><a class="gatr" target="_blank" rel="noopener" href="http://www.reddit.com/submit?url=https://e.printstacktrace.blog/using-sdkman-as-a-docker-image-for-jenkins-pipeline-a-step-by-step-guide/&amp;title=Using SDKMAN! as a docker image for Jenkins Pipeline - a step by step guide" data-type="share" data-name="Shared on Reddit"><i class="fa fa-reddit"></i></a></li><li><a class="gatr" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/button/?url=https://e.printstacktrace.blog/using-sdkman-as-a-docker-image-for-jenkins-pipeline-a-step-by-step-guide/&amp;media=https://e.printstacktrace.blog/images/cards/3.png&amp;description=Using SDKMAN! as a docker image for Jenkins Pipeline - a step by step guide" data-type="share" data-name="Shared on Pinterest"><i class="fa fa-pinterest"></i></a></li><li><a class="gatr" target="_blank" rel="noopener" href="https://ko-fi.com/eprintstacktrace" data-type="share" data-name="Clicked on Ko-Fi">‚òïÔ∏è</a></li></ul></div></div></div><div class="col-lg-9 py-5 order-0"><div class="pr-lg-4 px-1 pt-lg-5"><nav aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a class="gatr" href="/" data-type="breadcrumb" data-name="/">e.printstacktrace.blog</a></li><li class="breadcrumb-item"><a class="gatr" href="/jenkins-pipeline-cookbook/" data-type="breadcrumb" data-name="Jenkins Pipeline Cookbook">Jenkins Pipeline Cookbook</a></li></ol></nav><article class="post-body"><h1>Using SDKMAN! as a docker image for Jenkins Pipeline - a step by step guide</h1><div class="post-meta mb-4"><ul><li><time datetime="2019-11-06T18:34:01.000Z">November 6, 2019</time></li><li>14 min. read</li><li><a href="https://e.printstacktrace.blog/using-sdkman-as-a-docker-image-for-jenkins-pipeline-a-step-by-step-guide/#disqus_thread">0 Comments</a></li></ul></div><div class="content"><div class="paragraph"><p>A few days ago, I was struggling with some Docker images I use in my Jenkins CI environment. I run some Jenkins Pipelines, and I like to define build environment as code using custom Docker images. Everything was fine until I had to consider running different Java or Maven versions. I decided to use one of my favorite command-line tools - <a target="_blank" rel="noopener" href="https://sdkman.io/">SDKMAN!</a>, to build a highly configurable build environment.</p></div><a id="more"></a><div class="paragraph"><p>Let&#8217;s get directly into the details, and let&#8217;s start with defining a simple <code>Dockerfile</code> that installs SDKMAN! and expected Java and Maven versions.</p></div><div class="sect1"><h2 id="dockerfile">Dockerfile</h2><div class="sectionbody"><div class="listingblock"><div class="title">Listing 1. Dockerfile</div><div class="content"><pre class="highlightjs highlight"><code class="language-dockerfile hljs" data-lang="dockerfile">FROM debian:stretch-slim <i class="conum" data-value="1"></i><b>(1)</b>

# Defining default Java and Maven version <i class="conum" data-value="2"></i><b>(2)</b>
ARG JAVA_VERSION="11.0.6-amzn"
ARG MAVEN_VERSION="3.6.2"

# Defining default non-root user UID, GID, and name <i class="conum" data-value="3"></i><b>(3)</b>
ARG USER_UID="1000"
ARG USER_GID="1000"
ARG USER_NAME="jenkins"

# Creating default non-user <i class="conum" data-value="4"></i><b>(4)</b>
RUN groupadd -g $USER_GID $USER_NAME &amp;&amp; \
	useradd -m -g $USER_GID -u $USER_UID $USER_NAME

# Installing basic packages <i class="conum" data-value="5"></i><b>(5)</b>
RUN apt-get update &amp;&amp; \
	apt-get install -y zip unzip curl &amp;&amp; \
	rm -rf /var/lib/apt/lists/* &amp;&amp; \
	rm -rf /tmp/*

# Switching to non-root user to install SDKMAN! <i class="conum" data-value="6"></i><b>(6)</b>
USER $USER_UID:$USER_GID

# Downloading SDKMAN! <i class="conum" data-value="7"></i><b>(7)</b>
RUN curl -s "https://get.sdkman.io" | bash

# Installing Java and Maven, removing some unnecessary SDKMAN files <i class="conum" data-value="8"></i><b>(8)</b>
RUN bash -c "source $HOME/.sdkman/bin/sdkman-init.sh &amp;&amp; \
    yes | sdk install java $JAVA_VERSION &amp;&amp; \
    yes | sdk install maven $MAVEN_VERSION &amp;&amp; \
    rm -rf $HOME/.sdkman/archives/* &amp;&amp; \
    rm -rf $HOME/.sdkman/tmp/*"</code></pre></div></div><div class="paragraph"><p><em class="conum" data-value="1"></em> I use <code>debian:stretch-slim</code> in this example - a small 55 MB base docker image. It&#8217;s not the smallest available docker image, but it will work fine in our experiment. In our example, we will be using <a target="_blank" rel="noopener" href="https://aws.amazon.com/corretto/">Amazon Corretto JDK 11.0.6</a> - a distribution of OpenJDK from Amazon.com. We also want to install Maven 3.6.2 so we can run some <code>mvn clean install</code> command in the Jenkins Pipeline. We define both <em class="conum" data-value="2"></em> using <code>ARG</code> instruction<sup class="footnote">[<a id="_footnoteref_1" class="footnote" href="#_footnotedef_1" title="View footnote.">1</a>]</sup> so we can easily override default versions from the command line.</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ docker build --build-arg JAVA_VERSION=8.0.232-amzn ...</code></pre></div></div><div class="paragraph"><p>We are going to run the docker container as a non-root user. We define <em class="conum" data-value="3"></em> default <code>USER_UID</code>, <code>USER_GID</code> and <code>USER_NAME</code> using <code>ARG</code> instruction, and we create <em class="conum" data-value="4"></em> the user, his group and home directory. SDKMAN! requires tools like <code>curl</code>, <code>zip</code> and <code>unzip</code> - we need to install them <em class="conum" data-value="5"></em>.</p></div><div class="paragraph"><p>Before we install SDKMAN!, we are switching to our non-root user <em class="conum" data-value="6"></em> and we are ready to install SDKMAN! using <code>curl</code> <em class="conum" data-value="7"></em>. Th last step we need to do is to run <code>sdkman-init.sh</code> script and install expected Java and Maven <em class="conum" data-value="8"></em>.</p></div><div class="paragraph"><p>That&#8217;s our Dockerfile. Let&#8217;s build <code>sdkman:local</code> Docker image.</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ docker build -t sdkman:local .</code></pre></div></div><div class="paragraph"><p>Let&#8217;s run the container in the interactive mode (<code>-it</code>) and attach a <code>bash</code> process:</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash"><strong>$ docker run -it --rm  -u $(id -u) sdkman:local bash</strong>
jenkins@1c06914cb5ce:/<strong>$ java -version</strong>
openjdk version "11.0.6" 2020-01-14 LTS
OpenJDK Runtime Environment Corretto-11.0.6.10.1 (build 11.0.6+10-LTS)
OpenJDK 64-Bit Server VM Corretto-11.0.6.10.1 (build 11.0.6+10-LTS, mixed mode)
jenkins@1c06914cb5ce:/<strong>$ mvn -version</strong>
Apache Maven 3.6.2 (40f52333136460af0dc0d7232c0dc0bcf0d9e117; 2019-08-27T15:06:16Z)
Maven home: /home/jenkins/.sdkman/candidates/maven/current
Java version: 11.0.6, vendor: Amazon.com Inc., runtime: /home/jenkins/.sdkman/candidates/java/11.0.6-amzn
Default locale: en_US, platform encoding: ANSI_X3.4-1968
OS name: "linux", version: "5.5.10-100.fc30.x86_64", arch: "amd64", family: "unix"</code></pre></div></div><div class="paragraph"><p>It works like a charm! It&#8217;s time to set up a Jenkins Pipeline.</p></div></div></div><div class="sect1"><h2 id="jenkins-pipeline">Jenkins Pipeline</h2><div class="sectionbody"><div class="paragraph"><p>Let&#8217;s start by defining a simple Jenkins Pipeline.</p></div><div class="listingblock"><div class="title">Listing 2. Jenkinsfile</div><div class="content"><pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">pipeline &#123;
    agent &#123;
        docker &#123;
            image "sdkman:local" <i class="conum" data-value="1"></i><b>(1)</b>
        &#125;
    &#125;
    stages &#123;
        stage("Build") &#123;
            steps &#123;
                sh "java -version" <i class="conum" data-value="2"></i><b>(2)</b>
                sh "mvn -version" <i class="conum" data-value="3"></i><b>(3)</b>
            &#125;
        &#125;
    &#125;
&#125;</code></pre></div></div><div class="paragraph"><p>We start slowly. Firstly, we configure a docker agent that will start a container from our <code>sdkman:local</code> docker image <em class="conum" data-value="1"></em>. Secondly, we define a single <code>Build</code> stage and we want to verify if running Java <em class="conum" data-value="2"></em> and Maven <em class="conum" data-value="3"></em> are working. We run the pipeline and we see:</p></div><div class="openblock text-center"><div class="content"><div class="imageblock img-responsive img-thumbnail"><div class="content"><a class="image" href="/images/jenkins-pipeline-sdkman-fail.png"><div class="img-lazyload-container" style="width:1008px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==);background-repeat:no-repeat;background-position:center"><img data-original="/images/jenkins-pipeline-sdkman-fail.png" height="513" width="1008" style="padding-top:50.89285714285714%"></div></a></div></div></div></div><div class="paragraph"><p>The pipeline cannot found <code>java</code>? What? We just tested it with <code>docker run &#8230;&#8203; bash</code> and it worked! We look at the console log, we see that Jenkins docker agent spawned the right container. What&#8217;s the problem then?</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">Started by user Szymon Stepniak
Running in Durability level: MAX_SURVIVABILITY
[Pipeline] Start of Pipeline
[Pipeline] node
Running on Jenkins in /home/wololock/.jenkins/workspace/pipeline-with-sdkman
[Pipeline] &#123;
[Pipeline] sh
+ docker inspect -f . sdkman:local
.
[Pipeline] withDockerContainer
Jenkins does not seem to be running inside a container
$ docker run -t -d -u 1000:1000 -w /home/wololock/.jenkins/workspace/pipeline-with-sdkman -v /home/wololock/.jenkins/workspace/pipeline-with-sdkman:/home/wololock/.jenkins/workspace/pipeline-with-sdkman:rw,z -v /home/wololock/.jenkins/workspace/pipeline-with-sdkman@tmp:/home/wololock/.jenkins/workspace/pipeline-with-sdkman@tmp:rw,z -e ******** -e ******** -e ******** -e ******** -e ******** -e ******** -e ******** -e ******** -e ******** -e ******** -e ******** -e ******** -e ******** -e ******** -e ******** -e ******** -e ******** -e ******** -e ******** -e ******** -e ******** -e ******** -e ******** sdkman:local cat
$ docker top 064e63fd3795df643c4a7f676421b15ade9ae126f10efc6d3383509f7213c04b -eo pid,comm
[Pipeline] &#123;
[Pipeline] stage
[Pipeline] &#123; (Build)
[Pipeline] sh
+ java -version
/home/wololock/.jenkins/workspace/pipeline-with-sdkman@tmp/durable-ff41de0e/script.sh: 1: /home/wololock/.jenkins/workspace/pipeline-with-sdkman@tmp/durable-ff41de0e/script.sh: java: not found
[Pipeline] &#125;
[Pipeline] // stage
[Pipeline] &#125;
$ docker stop --time=1 064e63fd3795df643c4a7f676421b15ade9ae126f10efc6d3383509f7213c04b
$ docker rm -f 064e63fd3795df643c4a7f676421b15ade9ae126f10efc6d3383509f7213c04b
[Pipeline] // withDockerContainer
[Pipeline] &#125;
[Pipeline] // node
[Pipeline] End of Pipeline
ERROR: script returned exit code 127
Finished: FAILURE</code></pre></div></div><div class="paragraph"><p>What we missed? Could it be the entrypoint<sup class="footnote">[<a id="_footnoteref_2" class="footnote" href="#_footnotedef_2" title="View footnote.">2</a>]</sup>? In our <code>docker run &#8230;&#8203; bash</code> test we have executed Bash shell and the <code>.bashrc</code> script was executed, which added SDKMAN! candidates to the <code>PATH</code> environment variable. Let&#8217;s try to run <code>java -version</code> directly from the docker container and let&#8217;s see what happens:</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash"><strong>$ docker run --rm -u $(id -u) sdkman:local java -version</strong>
container_linux.go:247: starting container process caused "exec: \"java\": executable file not found in $PATH"
/usr/bin/docker-current: Error response from daemon: oci runtime error: container_linux.go:247: starting container process caused "exec: \"java\": executable file not found in $PATH".</code></pre></div></div><div class="paragraph"><p>OK, this is something. It looks like executing <code>java -version</code> without starting Bash shell makes <code>java</code> command missing in the <code>PATH</code> env variable. Let&#8217;s try to fix it by adding a simple <code>ENTRYPOINT</code> to our Dockerfile. For simplicity, we will use a command instead of a script file.</p></div><div class="listingblock"><div class="title">Listing 3. Dockerfile</div><div class="content"><pre class="highlightjs highlight"><code class="language-dockerfile hljs" data-lang="dockerfile">FROM debian:stretch-slim

# Defining default Java and Maven version
ARG JAVA_VERSION="11.0.6-amzn"
ARG MAVEN_VERSION="3.6.2"

# Defining default non-root user UID, GID, and name
ARG USER_UID="1000"
ARG USER_GID="1000"
ARG USER_NAME="jenkins"

# Creating default non-user
RUN groupadd -g $USER_GID $USER_NAME &amp;&amp; \
	useradd -m -g $USER_GID -u $USER_UID $USER_NAME

# Installing basic packages
RUN apt-get update &amp;&amp; \
	apt-get install -y zip unzip curl &amp;&amp; \
	rm -rf /var/lib/apt/lists/* &amp;&amp; \
	rm -rf /tmp/*

# Switching to non-root user to install SDKMAN!
USER $USER_UID:$USER_GID

# Downloading SDKMAN!
RUN curl -s "https://get.sdkman.io" | bash

# Installing Java and Maven, removing some unnecessary SDKMAN files
RUN bash -c "source $HOME/.sdkman/bin/sdkman-init.sh &amp;&amp; \
    yes | sdk install java $JAVA_VERSION &amp;&amp; \
    yes | sdk install maven $MAVEN_VERSION &amp;&amp; \
    rm -rf $HOME/.sdkman/archives/* &amp;&amp; \
    rm -rf $HOME/.sdkman/tmp/*"

ENTRYPOINT bash -c "source $HOME/.sdkman/bin/sdkman-init.sh &amp;&amp; $0 $@" <i class="conum" data-value="1"></i><b>(1)</b></code></pre></div></div><div class="paragraph"><p>In this example, we make sure that <code>sdkman-init.sh</code> script gets executed before any command triggered on the container. We can rebuild the docker image and try to run <code>java -version</code> again.</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash"><strong>$ docker build -t sdkman:local .</strong>
Sending build context to Docker daemon 3.584 kB
Step 1/12 : FROM debian:stretch-slim
 ---> c2f145c34384
Step 2/12 : ARG JAVA_VERSION="11.0.6-amzn"
 ---> Using cache
 ---> 6a3e406a9502
Step 3/12 : ARG MAVEN_VERSION="3.6.2"
 ---> Using cache
 ---> 15764ee0855a
Step 4/12 : ARG USER_UID="1000"
 ---> Using cache
 ---> a69f8849b91e
Step 5/12 : ARG USER_GID="1000"
 ---> Using cache
 ---> e58afc8d231f
Step 6/12 : ARG USER_NAME="jenkins"
 ---> Using cache
 ---> 4b12ba6ffbb2
Step 7/12 : RUN groupadd -g $USER_GID $USER_NAME && 	useradd -m -g $USER_GID -u $USER_UID $USER_NAME
 ---> Using cache
 ---> 4de53350c4bf
Step 8/12 : RUN apt-get update && 	apt-get install -y zip unzip curl && 	rm -rf /var/lib/apt/lists/\* && 	rm -rf /tmp/\*
 ---> Using cache
 ---> a3aaaeb15bda
Step 9/12 : USER $USER_UID:$USER_GID
 ---> Using cache
 ---> b39d53a9c785
Step 10/12 : RUN curl -s "https://get.sdkman.io" | bash
 ---> Using cache
 ---> 205c93608b5e
Step 11/12 : RUN bash -c "source $HOME/.sdkman/bin/sdkman-init.sh &&     yes | sdk install java $JAVA_VERSION &&     yes | sdk install maven $MAVEN_VERSION &&     rm -rf $HOME/.sdkman/archives/\* &&     rm -rf $HOME/.sdkman/tmp/\*"
 ---> Using cache
 ---> 1b4af7eec712
Step 12/12 : ENTRYPOINT bash -c "source $HOME/.sdkman/bin/sdkman-init.sh && $0 $@"
 ---> Using cache
 ---> 1d38b0879ab0
Successfully built 1d38b0879ab0

<strong>$ docker run --rm -u $(id -u) sdkman:local java -version</strong>
openjdk version "11.0.6" 2020-01-14 LTS
OpenJDK Runtime Environment Corretto-11.0.6.10.1 (build 11.0.6+10-LTS)
OpenJDK 64-Bit Server VM Corretto-11.0.6.10.1 (build 11.0.6+10-LTS, mixed mode)</code></pre></div></div><div class="paragraph"><p>Now, this is what we expect! We can run <code>java</code> and <code>mvn</code> commands without running Bash shell. We should be ready to go with the Jenkins Pipeline. Let&#8217;s restart it and see what happens.</p></div><div class="openblock text-center"><div class="content"><div class="imageblock img-responsive img-thumbnail"><div class="content"><a class="image" href="/images/jenkins-pipeline-sdkman-fail-again.png"><div class="img-lazyload-container" style="width:993px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==);background-repeat:no-repeat;background-position:center"><img data-original="/images/jenkins-pipeline-sdkman-fail-again.png" height="503" width="993" style="padding-top:50.65458207452165%"></div></a></div></div></div></div><div class="paragraph"><p>The same <code>java: not found</code> error&#8230;&#8203;</p></div></div></div><div class="sect1"><h2 id="how-to-fix-java-not-found-error-in-jenkins-pipeline">How to fix <code>java: not found</code> error in Jenkins Pipeline?</h2><div class="sectionbody"><div class="paragraph"><p>Why does the Jenkins Pipeline <code>sh</code> step fail to execute <code>java</code> command in our pipeline? The main reason why <code>java</code> cannot be found is that the <code>PATH</code> environment variable seems to be missing SDKMAN! candidates. Here is what the <code>PATH</code> of the <code>sdkman:local</code> docker container looks like:</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash"><strong>$ docker run --rm -u $(id -u) sdkman:local printenv | grep PATH</strong>
PATH=/home/jenkins/.sdkman/candidates/maven/current/bin:/home/jenkins/.sdkman/candidates/java/current/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin</code></pre></div></div><div class="paragraph"><p>And here is what the <code>PATH</code> variable looks like when we call <code>printenv</code> using <code>sh</code> pipeline step:</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">[Pipeline] sh
+ printenv
+ grep PATH
CLASSPATH=
PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin</code></pre></div></div><div class="paragraph"><p>There are at least two known issues<sup class="footnote">[<a id="_footnoteref_3" class="footnote" href="#_footnotedef_3" title="View footnote.">3</a>]</sup><sup class="footnote">[<a id="_footnoteref_4" class="footnote" href="#_footnotedef_4" title="View footnote.">4</a>]</sup> that seem to make updating <code>PATH</code> environment variable impossible.</p></div><div class="paragraph"><p>But what if I tell you that there is a solution to that problem? There are some workarounds, but their main problem is that they require specifying additional <code>PATH</code> env variable like <code>PATH+EXTRA</code> which means that you need to explicitly prepare yourself for missing <code>PATH</code> locations. I would accept it if there was no other option, but ideally no such workarounds should be necessary. And I have found a way how to do it.</p></div><div class="paragraph"><p></p><div class="kqwe9"><a class="gatr" href="https://www.udemy.com/course/jenkins-from-zero-to-hero/?ranMID=39197&amp;ranEAID=uow2LCEuhvQ&amp;ranSiteID=uow2LCEuhvQ-eudJSeLMRGPLc9IovvjfsA&amp;couponCode=NEWLEARNINGSF1" data-type="banner" data-name="jenkins-from-zero-to-hero" target="_blank"><img class="img-fluid border" data-lazy="/images/yml/jenkins-from-zero-to-hero.png"></a></div><p></p></div></div></div><div class="sect1"><h2 id="override-path-in-your-dockerfile">Override <code>PATH</code> in your Dockerfile</h2><div class="sectionbody"><div class="paragraph"><p>There is at least one way how you can override <code>PATH</code> variable used by the docker container started in the Jenkins Pipeline. You can do it using <code>ENV</code> instruction in your Dockerfile. We can construct <code>JAVA_HOME</code> and <code>MAVEN_HOME</code> environment variables (we know exactly where SDKMAN! installed both candidates), and then we can use it to override <code>PATH</code> variable. Here is what the final Dockerfile looks like:</p></div><div class="listingblock"><div class="title">Listing 4. Dockerfile</div><div class="content"><pre class="highlightjs highlight"><code class="language-dockerfile hljs" data-lang="dockerfile">FROM debian:stretch-slim

# Defining default Java and Maven version
ARG JAVA_VERSION="11.0.6-amzn"
ARG MAVEN_VERSION="3.6.2"

# Defining default non-root user UID, GID, and name
ARG USER_UID="1000"
ARG USER_GID="1000"
ARG USER_NAME="jenkins"

# Creating default non-user
RUN groupadd -g $USER_GID $USER_NAME &amp;&amp; \
	useradd -m -g $USER_GID -u $USER_UID $USER_NAME

# Installing basic packages
RUN apt-get update &amp;&amp; \
	apt-get install -y zip unzip curl &amp;&amp; \
	rm -rf /var/lib/apt/lists/* &amp;&amp; \
	rm -rf /tmp/*

# Switching to non-root user to install SDKMAN!
USER $USER_UID:$USER_GID

# Downloading SDKMAN!
RUN curl -s "https://get.sdkman.io" | bash

# Installing Java and Maven, removing some unnecessary SDKMAN files
RUN bash -c "source $HOME/.sdkman/bin/sdkman-init.sh &amp;&amp; \
    yes | sdk install java $JAVA_VERSION &amp;&amp; \
    yes | sdk install maven $MAVEN_VERSION &amp;&amp; \
    rm -rf $HOME/.sdkman/archives/* &amp;&amp; \
    rm -rf $HOME/.sdkman/tmp/*"

# ENTRYPOINT bash -c "source $HOME/.sdkman/bin/sdkman-init.sh &amp;&amp; $0 $@" <i class="conum" data-value="1"></i><b>(1)</b>

ENV MAVEN_HOME="/home/jenkins/.sdkman/candidates/maven/current" <i class="conum" data-value="2"></i><b>(2)</b>
ENV JAVA_HOME="/home/jenkins/.sdkman/candidates/java/current" <i class="conum" data-value="3"></i><b>(3)</b>
ENV PATH="$MAVEN_HOME/bin:$JAVA_HOME/bin:$PATH" <i class="conum" data-value="4"></i><b>(4)</b></code></pre></div></div><div class="colist arabic"><table><tr><td><i class="conum" data-value="1"></i><b>1</b></td><td>We can remove <code>ENTRYPOINT</code> at the moment.</td></tr><tr><td><i class="conum" data-value="2"></i><b>2</b></td><td>Here we define <code>MAVEN_HOME</code> using known Maven location.</td></tr><tr><td><i class="conum" data-value="3"></i><b>3</b></td><td>Here we define <code>JAVA_HOME</code> using known Java location.</td></tr><tr><td><i class="conum" data-value="4"></i><b>4</b></td><td>And last but not least - we override <code>PATH</code> using <code>$MAVEN_HOME/bin</code> and <code>$JAVA_HOME/bin</code>.</td></tr></table></div><div class="paragraph"><p>It&#8217;s time to rebuild the docker image.</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ docker build -t sdkman:local .</code></pre></div></div><div class="paragraph"><p>Let&#8217;s check if <code>java -version</code> command works.</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash"><strong>$ docker run --rm -u $(id -u) sdkman:local java -version</strong>
openjdk version "11.0.6" 2020-01-14 LTS
OpenJDK Runtime Environment Corretto-11.0.6.10.1 (build 11.0.6+10-LTS)
OpenJDK 64-Bit Server VM Corretto-11.0.6.10.1 (build 11.0.6+10-LTS, mixed mode)</code></pre></div></div><div class="paragraph"><p>It works! And now it is the time for the final test. Let&#8217;s restart the pipeline.</p></div><div class="openblock text-center"><div class="content"><div class="imageblock img-responsive img-thumbnail"><div class="content"><a class="image" href="/images/jenkins-pipeline-sdkman-success.png"><div class="img-lazyload-container" style="width:996px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==);background-repeat:no-repeat;background-position:center"><img data-original="/images/jenkins-pipeline-sdkman-success.png" height="771" width="996" style="padding-top:77.40963855421687%"></div></a></div></div></div></div></div></div><div class="sect1"><h2 id="why-even-bother-with-the-sdkman">Why even bother with the SDKMAN?</h2><div class="sectionbody"><div class="paragraph"><p>At this point, you may wonder why you should even consider using SDKMAN! instead of e.g. official Maven Docker image? As always - it depends. If you use a single Java/Maven/Gradle/"you name it" version in all your pipelines, then using one of the official docker images will do the trick for you. However, if you find yourself in a position where you need to run your e.g. Maven builds with different JDKs and different Maven versions, using the official Maven Docker image may become problematic. If you build your Dockerfile from the official Maven image, you are limited to a specific Java version, as well as a specific Maven version. When you want to use two different Maven versions with two different JDKs, you end up with 4 Dockerfiles - each one extends from different <code>maven</code> docker images.</p></div><div class="paragraph"><p>SDKMAN! solves that problem nicely. You can build a single Dockerfile, configure all your custom things in a single place, and you can use <code>ARG</code> instructions to build different versions from the same Dockerfile. Consider the following example.</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash"><strong>$ docker build -q --build-arg JAVA_VERSION=11.0.5-amzn --build-arg MAVEN_VERSION=3.5.4 -t sdkman:mvn-3.5.4-jdk-11.0.5-amzn .</strong>
sha256:fc6006992d79314758b0726f226cc5e87355708b9b7348e89599594b2b881d7c

<strong>$ docker build -q --build-arg JAVA_VERSION=11.0.5-amzn --build-arg MAVEN_VERSION=3.6.2 -t sdkman:mvn-3.6.2-jdk-11.0.5-amzn .</strong>
sha256:1e1699b478f404c66ed9cf75d122cd941f49e74de3c6e14d25520edfd8fd204b

<strong>$ docker build -q --build-arg JAVA_VERSION=13.0.1-zulu --build-arg MAVEN_VERSION=3.5.4 -t sdkman:mvn-3.5.4-jdk-13.0.1-zulu .</strong>
sha256:e804b0e7a71bc630d9c590c0e6c714155a7fbc46353b626720f7e53e8e7808c0

<strong>$ docker build -q --build-arg JAVA_VERSION=13.0.1-zulu --build-arg MAVEN_VERSION=3.6.2 -t sdkman:mvn-3.6.2-jdk-13.0.1-zulu .</strong>
sha256:d08fbd4ef3f889b0739d83d71e1d1f9da9bbf09b5d50d9418b661db6d8be80c7

<strong>$ docker run --rm -u $(id -u) sdkman:mvn-3.5.4-jdk-11.0.5-amzn mvn -version</strong>
Apache Maven 3.5.4 (1edded0938998edf8bf061f1ceb3cfdeccf443fe; 2018-06-17T18:33:14Z)
Maven home: /home/jenkins/.sdkman/candidates/maven/current
Java version: 11.0.5, vendor: Amazon.com Inc., runtime: /home/jenkins/.sdkman/candidates/java/11.0.5-amzn
Default locale: en_US, platform encoding: ANSI_X3.4-1968
OS name: "linux", version: "5.3.8-200.fc30.x86_64", arch: "amd64", family: "unix"

<strong>$ docker run --rm -u $(id -u) sdkman:mvn-3.6.2-jdk-13.0.1-zulu mvn -version</strong>
Apache Maven 3.6.2 (40f52333136460af0dc0d7232c0dc0bcf0d9e117; 2019-08-27T15:06:16Z)
Maven home: /home/jenkins/.sdkman/candidates/maven/current
Java version: 13.0.1, vendor: Azul Systems, Inc., runtime: /home/jenkins/.sdkman/candidates/java/13.0.1-zulu
Default locale: en_US, platform encoding: ANSI_X3.4-1968
OS name: "linux", version: "5.3.8-200.fc30.x86_64", arch: "amd64", family: "unix"</code></pre></div></div><div class="paragraph"><p>In this example, we have built four different docker images from the same Dockerfile. It makes the maintenance of all variants much more straightforward - when something requires fixing, we change a single Dockerfile and rebuild all tags.</p></div><div class="paragraph"><p></p><div class="youtube-row py-5"><div class="row"><div class="col-12 col-lg-5 text-lg-left text-center mb-lg-0 mb-4"><a class="thumb gatr d-inline-block" target="_blank" rel="noopener" href="https://youtu.be/j1lH3vOhucw" data-time="19:42" data-type="youtube" data-name="Jenkins Pipeline with multiple Java versions using Maven, Docker, and SDKMAN! | #jenkinspipeline"><img class="img-fluid shadow" data-lazy="https://i3.ytimg.com/vi/j1lH3vOhucw/mqdefault.jpg"></a></div><div class="col-12 col-lg-7"><h5 class="m-0 p-0 mb-3 text-lg-left text-center"><a class="gatr" target="_blank" rel="noopener" href="https://youtu.be/j1lH3vOhucw" data-type="youtube" data-name="Jenkins Pipeline with multiple Java versions using Maven, Docker, and SDKMAN! | #jenkinspipeline">Jenkins Pipeline with multiple Java versions using Maven, Docker, and SDKMAN! | #jenkinspipeline</a></h5><p class="sans-serif small text-lg-left text-justify">In this video, I show you how you can use Jenkins Declarative Pipeline to create a build pipeline that compiles the Maven Java project using three different Java versions (8, 11, and 15.) You will learn how to use a matrix section of the Jenkins Pipeline to define parallel stages, as well as how to create a Docker image that provides both Java and Maven using the powerful SDKMAN command-line tool. <a class="gatr font-weight-bold" target="_blank" rel="noopener" href="https://youtu.be/j1lH3vOhucw" data-type="youtube" data-name="Jenkins Pipeline with multiple Java versions using Maven, Docker, and SDKMAN! | #jenkinspipeline">Watch&nbsp;now&nbsp;&raquo;</a></p></div></div></div><p></p></div><div class="imageblock img-fluid"><a target="_blank" rel="noopener" href="https://kit.co/wololock/jenkins-pipeline-learning-kit" class="gatr" data-type="banner" data-name="Jenkins Pipeline Learning Kit 02"><div class="img-lazyload-container" style="width:920px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==);background-repeat:no-repeat;background-position:center"><img data-original="/images/yml/jenkins-pipeline-learning-kit-02.jpg" height="200" width="920" style="padding-top:21.73913043478261%"></div></a></div></div></div><div id="footnotes"><hr><div class="footnote" id="_footnotedef_1"><a href="#_footnoteref_1">1</a>. <a target="_blank" rel="noopener" href="https://docs.docker.com/engine/reference/builder/#arg" class="bare">https://docs.docker.com/engine/reference/builder/#arg</a></div><div class="footnote" id="_footnotedef_2"><a href="#_footnoteref_2">2</a>. <a target="_blank" rel="noopener" href="https://docs.docker.com/engine/reference/builder/#entrypoint" class="bare">https://docs.docker.com/engine/reference/builder/#entrypoint</a></div><div class="footnote" id="_footnotedef_3"><a href="#_footnoteref_3">3</a>. <a target="_blank" rel="noopener" href="https://issues.jenkins-ci.org/browse/JENKINS-45616" class="bare">https://issues.jenkins-ci.org/browse/JENKINS-45616</a></div><div class="footnote" id="_footnotedef_4"><a href="#_footnoteref_4">4</a>. <a target="_blank" rel="noopener" href="https://issues.jenkins-ci.org/browse/JENKINS-41339" class="bare">https://issues.jenkins-ci.org/browse/JENKINS-41339</a></div></div></div><ul class="tags-list mt-4"><li><a href="/t/java/">java</a></li><li><a href="/t/groovy/">groovy</a></li><li><a href="/t/docker/">docker</a></li><li><a href="/t/sdkman/">sdkman</a></li><li><a href="/t/devops/">devops</a></li><li><a href="/t/jenkins/">jenkins</a></li><li><a href="/t/jenkins-pipeline/">jenkins-pipeline</a></li><li><a href="/t/cicd/">cicd</a></li><li><a href="/t/maven/">maven</a></li></ul></article></div></div></div></div></section><section class="bg-dark posts-layout-01" id="related" data-debug="Scrolled to related posts"><div class="container py-5"><div class="row py-lg-5"><div class="col-12 col-lg-7 d-flex align-items-start mb-lg-0 mb-4"><div class="px-3 px-lg-0 pr-lg-5"><article><a href="/building-java-and-maven-docker-images-using-parallelized-jenkins-pipeline-and-sdkman/"><img class="mb-4 shadow" data-lazy="/images/cards/3.png" width="100%"></a><p class="subtitle m-0"><a href="/jenkins-pipeline-cookbook/">Jenkins Pipeline Cookbook</a></p><h3 class="m-0 serif"><a href="/building-java-and-maven-docker-images-using-parallelized-jenkins-pipeline-and-sdkman/">Building Java and Maven docker images using parallelized Jenkins Pipeline and SDKMAN!</a></h3><div class="post-meta mb-4"><ul><li><time datetime="2019-11-11T21:28:10.000Z">November 11, 2019</time></li><li>14 min. read</li><li><a href="https://e.printstacktrace.blog/building-java-and-maven-docker-images-using-parallelized-jenkins-pipeline-and-sdkman/#disqus_thread">0 Comments</a></li></ul></div><p class="small">In the last article, I have shown you how you can build a docker image for Jenkins Pipeline using SDKMAN! command-line tool. Today I will show you how you can build multiple different docker images using parallelized Jenkins Pipeline.</p></article></div></div><div class="col-12 col-lg-5"><div class="px-3 px-lg-0"><article class="tile"><div class="row mb-4"><div class="col-9"><p class="subtitle m-0"><a href="/jenkins-pipeline-cookbook/">Jenkins Pipeline Cookbook</a></p><h4 class="m-0 serif"><a href="/building-java-and-maven-docker-images-using-parallelized-jenkins-pipeline-and-sdkman/">Building Java and Maven docker images using parallelized Jenkins Pipeline and SDKMAN!</a></h4><div class="post-meta mb-4"><ul><li><time datetime="2019-11-11T21:28:10.000Z">November 11, 2019</time></li><li>14 min. read</li><li><a href="https://e.printstacktrace.blog/building-java-and-maven-docker-images-using-parallelized-jenkins-pipeline-and-sdkman/#disqus_thread">0 Comments</a></li></ul></div><p class="small">In the last article, I have shown you how you can build a docker image for Jenkins Pipeline usin...</p></div><div class="col-3"><a href="/building-java-and-maven-docker-images-using-parallelized-jenkins-pipeline-and-sdkman/"><img class="img-fluid rounded shadow-sm mt-3 mb-lg-0" data-lazy="/images/icons/19.png"></a></div></div></article><article class="tile"><div class="row mb-4"><div class="col-9"><p class="subtitle m-0"><a href="/jenkins-pipeline-cookbook/">Jenkins Pipeline Cookbook</a></p><h4 class="m-0 serif"><a href="/using-jenkins-pipeline-parallel-stages-to-build-maven-project-with-different-jdks/">Using Jenkins Pipeline parallel stages to build Maven project with different JDKs</a></h4><div class="post-meta mb-4"><ul><li><time datetime="2019-11-28T20:53:10.000Z">November 28, 2019</time></li><li>14 min. read</li><li><a href="https://e.printstacktrace.blog/using-jenkins-pipeline-parallel-stages-to-build-maven-project-with-different-jdks/#disqus_thread">0 Comments</a></li></ul></div><p class="small">In one of the latest blog posts, I have shown you how you can build a Docker image with Java and...</p></div><div class="col-3"><a href="/using-jenkins-pipeline-parallel-stages-to-build-maven-project-with-different-jdks/"><img class="img-fluid rounded shadow-sm mt-3 mb-lg-0" data-lazy="/images/icons/16.png"></a></div></div></article><article class="tile"><div class="row mb-4"><div class="col-9"><p class="subtitle m-0"><a href="/jenkins-pipeline-cookbook/">Jenkins Pipeline Cookbook</a></p><h4 class="m-0 serif"><a href="/how-to-time-out-jenkins-pipeline-stage-and-keep-the-pipeline-running/">How to time out Jenkins Pipeline stage and keep the pipeline running?</a></h4><div class="post-meta mb-4"><ul><li><time datetime="2020-04-16T07:28:38.000Z">April 16, 2020</time></li><li>14 min. read</li><li><a href="https://e.printstacktrace.blog/how-to-time-out-jenkins-pipeline-stage-and-keep-the-pipeline-running/#disqus_thread">0 Comments</a></li></ul></div><p class="small">The declarative Jenkins Pipeline allows us to define timeout either at the pipeline level or the...</p></div><div class="col-3"><a href="/how-to-time-out-jenkins-pipeline-stage-and-keep-the-pipeline-running/"><img class="img-fluid rounded shadow-sm mt-3 mb-lg-0" data-lazy="/images/icons/2.png"></a></div></div></article><a class="gatr" href="https://click.linksynergy.com/fs-bin/click?id=uow2LCEuhvQ&amp;offerid=572706.11&amp;type=3&amp;subid=0" data-type="banner" data-name="nordvpn-03" target="_blank"><img class="img-fluid" data-lazy="/images/yml/nord-vpn-03.png"></a></div></div></div></div></section><section class="sidebar-enabled" id="comments" data-debug="Scrolled to comments"><div class="container"><div class="row"><div class="col-12 col-lg-3 sidebar order-lg-1 order-0"><div class="py-lg-5 py-3 position-sticky text-center" style="top:20px"><div class="d-inline-block d-lg-none"><a class="gatr" href="https://www.jdoqocy.com/click-100191173-10952823" data-type="banner" data-name="grammarly-02" target="_blank"><img class="img-fluid" data-lazy="/images/yml/grammarly-02.png"></a></div><div class="d-none d-lg-inline-block"><a class="gatr" href="https://www.jdoqocy.com/click-100191173-10952823" data-type="banner" data-name="grammarly-01" target="_blank"><img class="img-fluid" data-lazy="/images/yml/grammarly-tower.png"></a></div></div></div><div class="col-12 col-lg-9 order-0 order-lg-0 order-1"><div class="pr-lg-5 py-5"><p class="m-0 serif small text-muted">Any thoughts or ideas?</p><h2 class="mb-4">Let's talk in the comment's section üí¨</h2><div class="disqus-comments"><div class="tip mb-5">Want to put a code sample in the comment? Read the <a target="_blank" rel="noopener" href="https://help.disqus.com/en/articles/1717236-syntax-highlighting"><b>Syntax highlighting</b></a> guide for more information.</div><div class="comments"><div id="disqus_thread"><div id="disqus_empty" style="display:none">Empty</div></div></div></div><script>function load_disqus(e){var t=document.getElementById("disqus_empty");if(document.contains(t)){var d=document.getElementById("disqus_thread"),n=document.createElement("script"),s=document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0];d&&t&&(t.remove(),n.type="text/javascript",n.async=!0,n.src="//"+e+".disqus.com/embed.js",s.appendChild(n))}}window.addEventListener("scroll",(function(e){document.scrollingElement.scrollTop>document.getElementById("disqus_thread").offsetTop-500&&load_disqus("eprintstacktrace")}),!1)</script></div></div></div></div></section></main><footer class="bg-dark" id="footer" data-debug="Scrolled to footer"><div class="container py-5"><div class="px-lg-0 px-3"><div class="row py-lg-3"><div class="col-12 col-md-6"><h5 class="mb-4">Latest blog posts</h5><ul class="list-unstyled mb-5"><li><a href="/merging-json-files-recursively-in-the-command-line/">Merging JSON files recursively in the command-line</a></li><li><a href="/jenkins-declarative-pipeline-dynamic-agent/">Jenkins Declarative Pipeline with the dynamic agent - how to configure it?</a></li><li><a href="/groovy-ecosystem-usage-report-2020/">Groovy Ecosystem Usage Report (2020)</a></li><li><a href="/how-to-convert-json-to-csv-from-the-command-line/">How to convert JSON to CSV from the command-line?</a></li><li><a href="/5-common-jenkins-pipeline-mistakes/">5 Common Jenkins Pipeline Mistakes</a></li><li><a href="/how-to-merge-two-maps-in-groovy/">How to merge two maps in Groovy?</a></li><li><a href="/building-stackoverflow-cli-with-java-11-micronaut-picocli-and-graalvm/">Building stackoverflow-cli with Java 11, Micronaut, Picocli, and GraalVM</a></li><li><a href="/how-to-catch-curl-response-in-jenkins-pipeline/">How to catch curl response in Jenkins Pipeline?</a></li><li><a href="/atomic-habits-book-review/">Atomic Habits - book review</a></li><li><a href="/parsing-json-in-command-line-with-jq-basic-filters-and-functions-part-1/">Parsing JSON in command-line with jq: basic filters and functions (part 1)</a></li></ul></div><div class="col-12 col-md-6"><h5 class="mb-4">Trending videos</h5><div class="youtube-row mb-4"><div class="row"><div class="col-12 col-lg-6 text-lg-left text-center mb-lg-0 mb-4"><a class="d-inline-block thumb gatr" target="_blank" rel="noopener" href="https://youtu.be/KwQDxwZRZiE" data-type="youtube" data-name="Jenkins Pipeline Environment Variables explained | #jenkinspipeline" data-time="16:43"><img class="img-fluid shadow" data-lazy="https://i3.ytimg.com/vi/KwQDxwZRZiE/mqdefault.jpg"></a></div><div class="col-12 col-lg-6"><h6 class="m-0 p-0 mb-3 sans-serif text-lg-left text-center px-lg-0 px-4"><a class="gatr" target="_blank" rel="noopener" href="https://youtu.be/KwQDxwZRZiE" data-type="youtube" data-name="Jenkins Pipeline Environment Variables explained | #jenkinspipeline">Jenkins Pipeline Environment Variables explained | #jenkinspipeline</a></h6><p class="sans-serif small text-justify">In today's video, I show you how you can work effectively with environment variables in the Jenkins pipeline as a code. You w...</p></div></div></div><div class="youtube-row mb-4"><div class="row"><div class="col-12 col-lg-6 text-lg-left text-center mb-lg-0 mb-4"><a class="d-inline-block thumb gatr" target="_blank" rel="noopener" href="https://youtu.be/aFRjn_4nb-Q" data-type="youtube" data-name="5 Common Jenkins Pipeline Mistakes üî•" data-time="17:46"><img class="img-fluid shadow" data-lazy="https://i3.ytimg.com/vi/aFRjn_4nb-Q/mqdefault.jpg"></a></div><div class="col-12 col-lg-6"><h6 class="m-0 p-0 mb-3 sans-serif text-lg-left text-center px-lg-0 px-4"><a class="gatr" target="_blank" rel="noopener" href="https://youtu.be/aFRjn_4nb-Q" data-type="youtube" data-name="5 Common Jenkins Pipeline Mistakes üî•">5 Common Jenkins Pipeline Mistakes üî•</a></h6><p class="sans-serif small text-justify">In this Jenkins Pipeline tutorial video, I reveal five common Jenkins Pipeline mistakes and I explain how those mistakes can ...</p></div></div></div></div></div><div class="row text-lg-left text-center"><div class="col-12 col-md-3 mb-lg-0 mb-4"><h5 class="mb-4">Useful links</h5><ul class="list-unstyled"><li><a class="gatr" href="/" data-type="footer-useful-links" data-name="Start here">Start here</a></li><li><a class="gatr" href="/about" data-type="footer-useful-links" data-name="About">About</a></li><li><a class="gatr" href="/archives" data-type="footer-useful-links" data-name="Archives">Archives</a></li><li><a class="gatr" href="/resources" data-type="footer-useful-links" data-name="Resources">Resources</a></li><li><a class="gatr" href="/privacy-policy" data-type="footer-useful-links" data-name="Privacy Policy">Privacy Policy</a></li><li><a class="gatr" target="_blank" rel="noopener" href="https://teespring.com/stores/eprintstacktrace" data-type="footer-useful-links" data-name="Merchandise">Merchandise</a></li><li><a class="gatr" target="_blank" rel="noopener" href="https://kit.co/wololock" data-type="footer-useful-links" data-name="My Kit">My Kit</a></li><li><a class="gatr" target="_blank" rel="noopener" href="https://feeds.feedburner.com/Eprintstacktracenet" data-type="footer-useful-links" data-name="RSS">RSS</a></li><li><a class="gatr" href="/support-me" data-type="footer-useful-links" data-name="Support me">Support the blog <em class="fas fa-heart color-red ml-2"></em></a></li></ul></div><div class="col-12 col-md-3 mb-lg-0 mb-4"><h5 class="mb-4">Popular categories</h5><ul class="list-unstyled"><li><a class="gatr" href="/groovy-cookbook/" data-type="footer-category" data-name="Groovy Cookbook">Groovy Cookbook<span class="count ml-2 text-muted">28</span></a></li><li><a class="gatr" href="/jenkins-pipeline-cookbook/" data-type="footer-category" data-name="Jenkins Pipeline Cookbook">Jenkins Pipeline Cookbook<span class="count ml-2 text-muted">9</span></a></li><li><a class="gatr" href="/programmers-bookshelf/" data-type="footer-category" data-name="Programmer's Bookshelf">Programmer's Bookshelf<span class="count ml-2 text-muted">6</span></a></li><li><a class="gatr" href="/micronaut-cookbook/" data-type="footer-category" data-name="Micronaut Cookbook">Micronaut Cookbook<span class="count ml-2 text-muted">4</span></a></li><li><a class="gatr" href="/ratpack-cookbook/" data-type="footer-category" data-name="Ratpack Cookbook">Ratpack Cookbook<span class="count ml-2 text-muted">4</span></a></li><li><a class="gatr" href="/learning-java/" data-type="footer-category" data-name="Learning Java">Learning Java<span class="count ml-2 text-muted">4</span></a></li><li><a class="gatr" href="/jq-cookbook/" data-type="footer-category" data-name="jq cookbook">jq cookbook<span class="count ml-2 text-muted">3</span></a></li><li><a class="gatr" href="/how-to/" data-type="footer-category" data-name="How to">How to<span class="count ml-2 text-muted">3</span></a></li><li><a class="gatr" href="/blog-reports/" data-type="footer-category" data-name="Blog Reports">Blog Reports<span class="count ml-2 text-muted">2</span></a></li></ul></div><div class="col-12 col-md-6"><h5 class="mb-4">Popular tags</h5><section class="tagcloud"><a href="/t/affiliate/" style="font-size:1.8em;color:#7b828b">affiliate</a> <a href="/t/async/" style="font-size:1.4em;color:#696f76">async</a> <a href="/t/benchmark/" style="font-size:1.6em;color:#727880">benchmark</a> <a href="/t/blogging/" style="font-size:1.2em;color:#60666b">blogging</a> <a href="/t/book/" style="font-size:2em;color:#848b95">book</a> <a href="/t/career/" style="font-size:1.2em;color:#60666b">career</a> <a href="/t/cicd/" style="font-size:2.4em;color:#969daa">cicd</a> <a href="/t/continuous-integration/" style="font-size:1.4em;color:#696f76">continuous-integration</a> <a href="/t/curl/" style="font-size:1.6em;color:#727880">curl</a> <a href="/t/devops/" style="font-size:2.2em;color:#8d94a0">devops</a> <a href="/t/docker/" style="font-size:1.6em;color:#727880">docker</a> <a href="/t/git/" style="font-size:1.2em;color:#60666b">git</a> <a href="/t/github/" style="font-size:1.4em;color:#696f76">github</a> <a href="/t/graalvm/" style="font-size:2.4em;color:#969daa">graalvm</a> <a href="/t/gradle/" style="font-size:1.2em;color:#60666b">gradle</a> <a href="/t/grails/" style="font-size:1.4em;color:#696f76">grails</a> <a href="/t/groovy/" style="font-size:3em;color:#b1b9ca">groovy</a> <a href="/t/haskell/" style="font-size:1.4em;color:#696f76">haskell</a> <a href="/t/hexo/" style="font-size:1.2em;color:#60666b">hexo</a> <a href="/t/java/" style="font-size:2.8em;color:#a8b0bf">java</a> <a href="/t/java-8/" style="font-size:1.4em;color:#696f76">java-8</a> <a href="/t/jenkins/" style="font-size:2.6em;color:#9fa7b5">jenkins</a> <a href="/t/jenkins-pipeline/" style="font-size:2.6em;color:#9fa7b5">jenkins-pipeline</a> <a href="/t/jenkinsfile/" style="font-size:1.4em;color:#696f76">jenkinsfile</a> <a href="/t/jmh/" style="font-size:1.8em;color:#7b828b">jmh</a> <a href="/t/jq/" style="font-size:1.6em;color:#727880">jq</a> <a href="/t/json/" style="font-size:1.6em;color:#727880">json</a> <a href="/t/junit/" style="font-size:1.4em;color:#696f76">junit</a> <a href="/t/learning/" style="font-size:1.6em;color:#727880">learning</a> <a href="/t/maven/" style="font-size:1.4em;color:#696f76">maven</a> <a href="/t/metaprogramming/" style="font-size:1.2em;color:#60666b">metaprogramming</a> <a href="/t/micronaut/" style="font-size:2em;color:#848b95">micronaut</a> <a href="/t/native-image/" style="font-size:1.8em;color:#7b828b">native-image</a> <a href="/t/non-blocking/" style="font-size:1.6em;color:#727880">non-blocking</a> <a href="/t/progress/" style="font-size:1.2em;color:#60666b">progress</a> <a href="/t/ratpack/" style="font-size:2.4em;color:#969daa">ratpack</a> <a href="/t/reactive-programming/" style="font-size:1.4em;color:#696f76">reactive-programming</a> <a href="/t/reading/" style="font-size:1.4em;color:#696f76">reading</a> <a href="/t/recursion/" style="font-size:1.4em;color:#696f76">recursion</a> <a href="/t/review/" style="font-size:2em;color:#848b95">review</a> <a href="/t/rxjava/" style="font-size:1.4em;color:#696f76">rxjava</a> <a href="/t/sdkman/" style="font-size:1.6em;color:#727880">sdkman</a> <a href="/t/session/" style="font-size:1.2em;color:#60666b">session</a> <a href="/t/split/" style="font-size:1.2em;color:#60666b">split</a> <a href="/t/spock/" style="font-size:1.6em;color:#727880">spock</a> <a href="/t/stackoverflow/" style="font-size:1.4em;color:#696f76">stackoverflow</a> <a href="/t/string/" style="font-size:1.4em;color:#696f76">string</a> <a href="/t/tail-call/" style="font-size:1.2em;color:#60666b">tail-call</a> <a href="/t/tail-recursion/" style="font-size:1.2em;color:#60666b">tail-recursion</a> <a href="/t/unit-test/" style="font-size:1.6em;color:#727880">unit-test</a></section></div></div></div></div><section class="bottom"><div class="container"><ul class="text-center py-1 m-0"><li class="d-inline-block">Designed by <a class="gatr" target="_blank" rel="noopener" href="https://twitter.com/wololock" data-type="footer" data-name="designed">@wololock</a></li><li class="d-inline-block">Created with <a class="gatr" target="_blank" rel="noopener" href="https://hexo.io" data-type="footer" data-name="hexo">Hexo</a></li><li class="d-inline-block">Hosted on <a class="gatr" target="_blank" rel="noopener" href="https://github.com/wololock/wololock.github.io" data-type="footer" data-name="github">GitHub</a></li><li class="d-inline-block">Deployed with <a class="gatr" target="_blank" rel="noopener" href="https://circleci.com/gh/wololock/wololock.github.io" data-type="footer" data-name="circleci">Circle CI</a></li><li class="d-inline-block">License <a class="gatr" target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/" data-type="footer" data-name="license">CC BY-NC-SA 4.0</a></li><li class="d-inline-block"><a class="gatr" target="_blank" rel="noopener" href="https://github.com/wololock/wololock.github.io/commits/develop" data-type="footer" data-name="last-commit"><img data-lazy="https://badgen.net/github/last-commit/wololock/wololock.github.io?color=blue&amp;scale=0.8"></a></li></ul></div></section></footer><script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script><script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/48c5da59c9.js" crossorigin="anonymous" async></script><script async id="cookiebanner" src="//cdnjs.cloudflare.com/ajax/libs/cookie-banner/1.2.2/cookiebanner.min.js" data-moreinfo="/privacy-policy/" data-message="This blog uses cookies to enhance your experience. By continuing to visit it you agree to its use of cookies." data-link="#5fc4ff" data-font-family="Lora,serif" data-font-size="16px" data-bg="#1d2b36"></script><script src="/js/main.js?v=11"></script><script src="/js/highlightjs/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad()</script><script async id="dsq-count-scr" src="//eprintstacktrace.disqus.com/count.js"></script><script>!function(e,t,a,c,n,i,r){e.GoogleAnalyticsObject=n,e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=1*new Date,i=t.createElement(a),r=t.getElementsByTagName(a)[0],i.async=1,i.src="//www.google-analytics.com/analytics.js",r.parentNode.insertBefore(i,r)}(window,document,"script",0,"ga"),ga("create","UA-42400890-5","auto"),ga("send","pageview"),jQuery(document).on("mousedown","a.gatr",(function(e){var t=jQuery(this),a=t.attr("data-type"),c=t.attr("data-name"),n=1===e.which?"click":2===e.which?"middle-click":"right-click";return ga("send","event",a,n,c),!0})),jQuery(document).on("mousedown","#related a",(function(e){var t=jQuery(this),a=1===e.which?"click":2===e.which?"middle-click":"right-click";return ga("send","event","related",a,t.attr("href")),!0})),jQuery(document).on("mousedown","#footer a",(function(e){var t=jQuery(this),a=1===e.which?"click":2===e.which?"middle-click":"right-click";return ga("send","event","footer",a,t.attr("href")),!0}))</script><script>!function(){"use strict";function r(e){var t=e.getAttribute("data-original"),n=new Image;n.onload=function(){e.setAttribute("src",t),e.style.paddingTop=""},n.src=t}document.addEventListener("DOMContentLoaded",function(){var t,e,n,i=Array.prototype.slice.call(document.querySelectorAll("img[data-original]"));i.length&&("undefined"!=typeof IntersectionObserver?(t=new IntersectionObserver(function(e,t){e.filter(function(e){return e.isIntersecting}).forEach(function(e){r(e.target),t.unobserve(e.target)})}),i.forEach(function(e){t.observe(e)})):(n=function(){clearTimeout(e),e=setTimeout(function(){return(i=i.filter(function(e){return!e.src})).length?void i.filter(function(e){e.getBoundingClientRect().top<window.innerHeight&&r(e)}):(window.removeEventListener("scroll",n),void window.removeEventListener("resize",n))},100)},window.addEventListener("scroll",n),window.addEventListener("resize",n),n()))},!1)}();</script></body></html>